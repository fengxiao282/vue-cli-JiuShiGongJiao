#大屏与数据中心接口 v3.41

###修订历史

>2019-04-11	v3.1

	按模块和功能点将V3.0中接口重编排 归纳到3.1节 云监控-异常监控
		3.1.1大间隔异常情况统计
		3.1.2车辆异常处理
		3.1.3车辆进出场异常统计
		3.1.4新能源异常报警统计
		3.1.5一车一检情况统计
		3.1.6异常提醒
	新增5.1节 云智库-智库首页
		5.1.1核心要素概况
		5.1.2营运综合评价指标
		5.1.3安全管控

>2019-04-12 v3.2

	新增5.1.4.智慧机务
		5.1.4.1留交车辆
		5.1.4.2车辆路救
		5.1.4.3千公里材料费		
		5.1.4.4新能源续航
	新增5.2数据中心
		5.2.1节点机负载
		5.2.2云服务器集群虚拟机分配情况
		5.2.3运维记录

>2019-04-13 v3.3

	修订
		5.2.2增加各分组内虚拟机负载详情
	新增
		3.1.7起讫站发车流水
		5.2.4存储开支情况统计
		5.2.5机房人员进入记录
		5.2.6接入及共享业务系统
		5.2.7数据流量统计
		5.2.8数据资产监控
			5.2.8.1库资源结构图示
			5.2.8.2数据资产统计项目

>2019-04-14 v3.4

	新增
		3.2资源投入
		3.2.1车辆投入
		3.2.2班次投入
		3.2.3营运公里执行
		3.2.4运送客流
		3.2.5司机投入
		3.2.6调度员投入
		3.2.7现场管理投入
		3.2.8停车场管理
		3.2.9到站预报准确率
		3.2.10指挥中心人员情况

>2019-04-15 v3.5

	新增
		3.3营运全过程
		3.3.1 7:30汇报
		3.3.2 9:30和19:30汇报
		3.3.3 11:30、21:30和22:30汇报
		3.3.4 13:30汇报
		3.3.5 15:30汇报
		3.3.6 17:30汇报
		3.4重点线路指标
		3.4.1一类线路指标统计表
		3.4.2三类线路指标统计表

>2019-04-16 v3.6

	新增
		3.4.3早高峰出车、晚高峰出车（一类线路）指标明细表
		3.4.4早高峰班次、晚高峰班次（一类线路）指标明细表
		3.4.5大间隔（一类线路、三类线路）指标明细表
		3.4.6全日出车（三类线路）指标明细表
		3.4.7全日班次（三类线路）指标明细表

>2019-04-24 v3.7

	新增
		5.3乘客密度分析
		5.3.1舒适度分析应用
		5.3.1.1车厢视频分析
		5.3.1.2舒适度情况
		5.3.1.3线路舒适度示意线
		5.3.2POS数据分析应用
		5.3.2.1线路客流排名
		5.3.2.2站点客流排名

>2019-04-26 v3.8

	修订
		5.3.2.1线路客流排名
		5.3.2.2站点客流排名
		2个接口返回数据格式，原格式描述对象和数组时符号错误予以修正
	新增
		新增接口地址及URI说明
>2019-04-28 v3.9

	修订
		5.3.2.1 目录名称改为 站点客流排名
		5.3.2.2 目录名称改为 线路客流排名
	新增
		拆分目录3.3 营运全过程，新增合计18个小标题

>2019-04-28 v3.10

	修订
		5.2.3运维记录
			"onlineIp":"在线运维人员ip" 由单一属性改为 数组 "online":[]
			访问记录中增加用户名
		5.2.5机房人员进入情况
			返回数据由单一对象改为数组
			增加属性 "status":"状态 进入机房 或 离开机房"

>2019-04-28 v3.11

	修订
		5.2.6接入及共享业务系统
			"id":"系统id或编号" 应接口提供方要求改为 "ids":"系统id或编号" 功能不变
			增加"status":"状态 正常 或 异常"
>2019-04-29 v3.12

	修订
		3.3.2.2 增加了请求参数type字段，并调整了json格式：
			删除字段：
				"departRatioM":"早高峰出车率",
				"shiftRatioM":"早高峰班次完成率",
				"departRatioE":"晚高峰出车率",
				"shiftRatioE":"晚高峰班次完成率"。
			新增字段：
				"departRatio":"早晚高峰出车率",
				"shiftRatio":"早晚高峰班次完成率"。
		3.3.2.3 增加了请求参数type字段，并调整了json格式：
			删除字段：
				"departRatioM":"早高峰出车率",
				"shiftRatioM":"早高峰班次完成率",
				"departRatioE":"晚高峰出车率",
				"shiftRatioE":"晚高峰班次完成率"。
			新增字段：
				"departRatio":"早晚高峰出车率",
				"shiftRatio":"早晚高峰班次完成率"。

>2019-04-29 v3.13

	修订
		5.2.8.1库资源结构图示
			增加字段 "childSiz":"l" //下层数据资源数量级 值为字符串 s|m|l, 少:s,中等:m,多:l

>2019-04-29 v3.14

	修订
		5.2.1 调整了json格式：
			删除字段：
				"id":"设备ID"。
			新增字段：
				"uid":"设备ID"。
		5.2.2 调整了json格式：
			删除字段：
				"id":"虚拟机id"。
			新增字段：
				"uid":"虚拟机ID"。
		5.2.6 调整了json格式：
			删除字段：
				"ids":"系统id或编号"。
			新增字段：
				"uid":"系统id或编号"。
		5.2.8.1 调整了json格式：
			删除字段：
				"id":"数据库id"。
			新增字段：
				"uid":"数据库ID"。

>2019-05-06 v3.15

	修订
		3.3.2.3 修正字段拼写错误 depart.ration -> depart.ratio
		3.3.3.3 修正字段拼写错误 largeInterval.ration -> largeInterval.ratio
		3.3.4.3 修正字段拼写错误 largeInterval.ration -> largeInterval.ratio
		5.2.8.2 数据资产统计项目 增加资源变动字段 
	新增
		3.1.8 大客流站点情况

>2019-05-07 v3.16

	修订
		调整了接口地址及URI说明，新增报文格式Headers、Body。
		3.3.2.1 删除了请求参数type，新增请求参数collectionName及其枚举数值。
		3.3.2.2 删除了请求参数type，新增请求参数collectionName及其枚举数值。
		3.3.2.3 删除了请求参数type，新增请求参数collectionName及其枚举数值。
		3.3.3.1 删除了请求参数start、end，新增请求参数collectionName及其枚举数值。
		3.3.3.2 删除了请求参数start、end，新增请求参数collectionName及其枚举数值。
		3.3.3.3 删除了请求参数start、end，新增请求参数collectionName及其枚举数值。

>2019-05-08 v3.17

	修订
		3.3.3.1 调整了json返回参数：
			删除了largeInterval、abnormal。
			新增了largeIntervalCt、abnormalCt。
		3.3.3.2 调整了json返回参数：
			删除了largeInterval、abnormal。
			新增了largeIntervalCt、abnormalCt。
		3.3.4.1 调整了json返回参数：
			删除了largeInterval、abnormal。
			新增了largeIntervalCt、abnormalCt。
		3.3.4.2 调整了json返回参数：
			删除了largeInterval、abnormal。
			新增了largeIntervalCt、abnormalCt。
		3.3.5.1 调整了json返回参数：
			删除了abnormal。
			新增了abnormalCt。
		3.3.5.2 调整了json返回参数：
			删除了largeInterval、abnormal。
			新增了largeIntervalCt、abnormalCt。
		3.3.6.1 调整了json返回参数：
			删除了abnormal、overSpeed。
			新增了abnormalCt、overSpeedCt。
		3.3.6.2 调整了json返回参数：
			删除了largeInterval、abnormal和overSpeed。
			新增了largeIntervalCt、abnormalCt和overSpeedCt。

>2019-05-08 v3.18

	修订
		3.1.6异常提醒
			修改异常类型:车辆异常、SOC、三级报警、大间隔、进出场、一车一检
		3.2.10指挥中心人员情况
			各分指挥中心增加commander 指挥长字段

>2019-05-10 v3.19

	修订
		3.3.2.3 调整了json返回参数：
			删除了idx。
		3.3.3.3 调整了json返回参数：
			删除了idx。
		3.3.4.3 调整了json返回参数：
			删除了idx。
		3.3.5.3 调整了json返回参数：
			删除了idx。
		3.3.6.3 调整了json返回参数：
			删除了idx。
		5.1.2营运综合评价指标
			重新拆分成3个新的接口。

>2019-05-13 v3.20

	修订
		5.1.2.1 调整了json格式。
		5.1.2.2 调整了json格式。
		5.1.2.3 调整了json格式。

>2019-05-17 v3.21

	修订
		3.3.3 11:30、21:30和22:30汇报 改为 3.3.3 11:30、21:30汇报
			22:30汇报格式与11:30、21:30不同，从中剔除
		3.4.2三类线路指标统计表
			增加计划外区间发生率 outPlanRat、首末班车准点率 firstLastOntimeRat、起讫站发车准点率 startOntimeRat
	新增
		3.3.7 22:30汇报
			与11:30，21:30相比，在公司内容、车队内容中多了进场准点率

>2019-05-30 v3.22

	新增
		3.5 安全管控
			3.5.1 客伤警报
			3.5.2 DVR实时监控违规违操情况
		3.6 服务管控
			3.6.1 服务热线情况
			3.6.2 舆情监控情况
			3.6.3 站点通、报到机、站点设施工作状态
			3.6.4 电子站牌工作状态
		3.7 机务保障
			3.7.1 车辆总体情况
			3.7.2 维修、保养、留交详细情况
			3.7.3 三天一覆盖执行情况
			3.7.4 新能源车远程监控情况
		3.8 场站保障
			3.8.1 人员上岗
			3.8.2 营运车辆进出场情况
			3.8.3 设施设备、危险源、违章监控
			3.8.4 节假日及重大活动情况汇报
		5.3.3GIS地图图示应用
			5.3.3.1站点客流实时数据
			5.3.3.2站点客流分时段数据
			5.3.3.3 上月运送客流
			5.3.3.4 站点客流明细
			5.3.3.5车辆舒适度分时段数据

>2019-06-04 v3.23

	修订
		3.5.1 调整reportUrl为reportList

>2019-06-06 v3.24

	修订
		5.3.2.1 调整了请求参数。
		5.3.2.2 调整了请求参数。

>2019-06-10 v3.25

	修订
		3.1.6 异常提醒，增加如下字段，所增加字段异常消息无法提供时填空字符串
			stationCode 站点编码
			parking 停车场名称
			updown 上下行

>2019-06-10 v3.26

	新增
		4.1 指挥首页
			4.1.1 常规公交线
			4.1.2 轨交应急线
			4.1.3 应急支援车辆
		4.2 应急支援
			4.2.1 应急预案

>2019-06-12 v3.27

	新增
		3.5.1 新增事故具体发生时间的字段，格式为年-月-日 时:分

>2019-06-13 v3.28

	新增 3.9 供电保障
		3.9.1 抢修车配车情况、新能源充电站设备运行情况、新能源充电营运数据
		3.9.2 电车架空线网、电车整流站设备运行情况
		3.9.3 车辆充电情况
		3.9.4 重大突发情况

>2019-06-14 v3.29

	修订
		5.1.4.4 新能源续航  改为：新能源报警分析

>2019-06-15 v3.30

	修订
		删除了4.2目录
		调整了4.1目录

>2019-06-17 v3.31

	修订
		调整4.1.1.2 json格式

>2019-06-18 v3.32

	修订
		调整4.1.1.4 json格式,增加了itemId字段

>2019-06-24 v3.33

	新增
		1.2 首页-三级监控指挥体系

>2019-06-24 v3.34

	新增
		2.1 站点、预报屏统计

>2019-06-27 v3.35

	新增
		调整 3.8.3 json格式

>2019-06-27 v3.36

	新增
		2.2 人员

> 2019-08-07 v3.37

```
更新
	4.1.1.2 单笔应急方案线路清单 
		每条线路增加 status 启动状态字段
		应急线路增加 beginPoint 起点经纬度、endPoint 终点经纬度 字段
新增
	4.1.1.5 应急预案线路起讫点及轨迹
	4.1.1.6 线路班次
	4.1.1.7 现场管理人员上岗计划
	4.1.2 应急资源查询工具
	4.1.2.1 查询目标点附近起讫站及可调用车辆
	4.1.2.2 保存目标点附近起讫站及可调用车辆查询结果
	4.1.2.3 资源配置档案列表
	4.1.2.4 资源配置档案详情
```

> 2019-08-08 v3.38

```
更新 
  4.1.1.3 线路配车明细 
  	字段变更 新增 公司、应急编号
  4.1.1.6 线路班次 
  	字段变更 新增 车牌号、车辆编号
  4.1.1.7 上岗人员管理计划 
  	字段变更 删除 车队 上岗时间	新增 职位 电台编号
新增
	4.1.1.8 线路预案进度和资源投入情况
```

>2019-08-12 v3.39

```
更新
 4.1.1.8 线路预案进度和资源投入情况
 	预案进度改为数组 详见接口描述中 预案进度描述
 	支援公司不区分起点和终点，支援起点公司、支援终点公司合并为支援公司
```

>2019-08-13 v3.40

```
更新
 4.1.1.8 线路预案进度和资源投入情况
 预案进度 第一辆车出发、第一辆车到达 两个状态中时间分为赶往起点方向时间timeToBegin、赶往终点方向时间 timeToEnd
```

> 2019-08-13 v3.41

```
更新
4.1.2.1 查询目标点附近起讫站及可调用车辆
增加2个字段 begin （起点信息）、end （终点信息）将原结构按起点信息和终点信息分类到begin、end
4.1.2.4资源配置档案详情
增加字段 begin （起点信息）、end （终点信息）将原结构按起点信息和终点信息分类到begin、end
增加字段 itemName 预案名称 、line 线路名 、createTime 创建时间
```




[TOC]

#接口地址及URI说明
**根路径**

http://203.156.246.55:2205/ScreenCenter/getScreenData

**报文格式：Headers**

|     KEY      | 是否必填 |      VALUE       |
| :----------: | :--: | :--------------: |
| Content-Type |  是   | application/json |

**报文格式：Body**

|       参数       | 是否必填 |  格式   |                    说明                    |
| :------------: | :--: | :---: | :--------------------------------------: |
| collectionName |  是   | 3_1_1 | 默认值：各具体接口子路径是接口编号用下划线 _ 连接。有特殊情况会在各接口参数中表明。 |
|      ...       | ...  |  ...  |                   ...                    |

	例如: Postman工具
	Host: 203.156.246.55:2205
	Content-Type: application/json
	cache-control: no-cache
	Postman-Token: 09468f12-f28d-4771-9837-2d8b1a0a2a9e
	{
	    "collectionName": "3_3_1_3",
	    "branchCode":"00-01-01"
	}



# 1 首页
参见《大屏与数据中心接口V2.14》
## 1.1 七类专岗
## 1.2 三级监控指挥体系
返回线路、车辆、人员、停车场、站点和日均客流数据

**请求参数**

无

**返回**

	{
		"line_num": "线路总数",
		"bus_num": "车辆总数",
		"person_num": "人员总数",
		"parking_num": "停车场总数",
		"hubstation_num": "枢纽站总数",
		"station_num": "站点总数",
		"passenger_num": "日均客流数"
	}

# 2 云全景
参见《大屏与数据中心接口V2.14》
##2.1 站点，预报屏统计
返回中途站，起讫站，枢纽站，站点总数/oled,32寸led,55寸lcd,电子墨水屏统计，预报屏总数

**请求参数**
无
**返回**
	{
		"middleStopStation": "中途站数",
		"startStation": "起讫站总数",
		"hubStation": "枢纽站总数",
		"stationTotal": "站点总数",
		"oled": "oled数",
		"led32": "32寸led数",
		"lcd55": "55寸lcd数",
		"ink": "电子墨水屏数",
		"screenTotal": "预报屏总数"
	}
##2.2 人员
返回人员总数，司售总数，驾驶员数量，售票员数量

**请求参数**
无
**返回**
	{
		"total_person": "人员总数",
		"driver_conductor": "司售总数",
		"driver": "驾驶员数量",
		"conductor": "售票员数量",
	}

# 3 云监控
## 3.1 异常监控
### 3.1.1 大间隔异常情况统计	博协
返回当日实时数据 列表数据按发生时间倒序排列

**请求参数**

无

**返回**

	{
		//统计
		"summary":{
			"day":"全日数",
			"earlyPeak":"早高峰",
			"latePeak":"晚高峰"
		},
		//明细列表
		"list": [
			{
				"startTime":"发生时间",
				"endTime":"结束时间",
				"line":"线路",
				"station":"站点",
				"duration":"持续时间",
				"reason":"原因"
			}
		]
	}

### 3.1.2 车辆异常处理统计	博协
返回当日实时数据

**请求参数**

无

**返回**

	{
		"alarm":"报警数",
		"processed":"已处理数",
		"accident":"事故数",
		"fault":"故障数",
		"dispute":"纠纷数"
	}

### 3.1.3 车辆进出场异常统计	博协
返回当日实时数据

**请求参数**

无

**返回**

	{
		"list":[
			{
				"parking":"停车场",
				"in":"异常进场数",
				"out":"异常出场数"a
			}
		]
	}

### 3.1.4 新能源异常报警统计	宁德
返回当日实时数据

**请求参数**

无

**返回**

	{
		"level3":"三级报警数",
		"level2":"二级报警数",
		"level1":"一级报警数"
	}

### 3.1.5 一车一检情况统计	交投
返回当日实时数据

**请求参数**

无

**返回**

	{
		"list":[
			{
				"parking":"停车场",
				"check":"日检查次数",
				"exception":"日检查异常次数"
			}
		]
	}

### 3.1.6 异常提醒	多家综合流水
返回当前时段各类异常流水，以websoket方式推送json对象

单笔数据格式

	{
		"type":"异常类型 车辆异常、SOC、三级报警、大间隔、进出场、一车一检",
		"startTime":"发生时间",
		"endTime": "结束时间 无则空"
		"line":"线路",
		"vno":"车辆编号",
		"stationCode":"站点编号",
		"parking":"停车场名称",
		"upDown":"上下行 0:上行、1:下行",
		"lng":"经度",
		"lat":"纬度",
		"reason":"异常原因 无则空",
		"result":"处理结果 无则空"
	}

### 3.1.7 起讫站发车流水 
各起讫站当前实时发车数据，每个班次发车时推送json对象

单笔数据格式

	{
		"upDown": "上下行 上行:0、下行:1",       		
		"stationName": "发车点名称如 汉口路江西中路",
		"lupai": "路牌",
		"planTime": "计划发车时间 08:59",
		"actTime": "实际发车时间 08:59",            
		"diff": "差值",            		  
		"isOk": "是否准点 准点:1、不准点:0",
		"planVNO": "计划自编号",        
		"actVNO": "实际自编号",         
	}

### 3.1.8 大客流站点
实时统计站点上车客流时间断面情况（例如：15分钟），并依据客流情况进行站点排序。

数据统计类型包括站点名称、15分钟累计客流、平均客流（人次/分钟）。

**请求参数**

无

**返回**

	[
		{
			"idx":"排名",
			"station":"站名",
			"periodCount":"时段累计客流",
			"average":"平均客流 人次/分钟"
		}...
	]	

## 3.2资源投入
### 3.2.1车辆投入
按集团、公司显示车辆投入实际/计划情况，提供百分比指数。
提供百分比指数和实际/计划数切换按键

**请求参数**

无

**返回**

```
[
//集团排在集合第一行，其它公司按名称升序排列
	{
		"name":"集团或公司名称 如集团、一公司、二公司",
		"plan":"计划",
		"actual":"实际",
		"ratio":"百分比指数 数值不带%"
	}...
]
```



### 3.2.2班次投入
按集团、公司显示班次投入实际/计划情况，提供百分比指数。

**请求参数**

无

**返回**

	[
		//集团排在集合第一行，其它公司按名称升序排列
		{
			"name":"集团或公司名称 如集团、一公司、二公司",
			"plan":"计划",
			"actual":"实际",
			"ratio":"百分比指数 数值不带%"
		}...
	]

### 3.2.3营运公里执行
显示当日集团实时营运公里执行累计数

**请求参数**

无

**返回**
​	
	//直接返回公里数，格式为数值非json对象，如
	1058000


​	
### 3.2.4运送客流
滚动显示当日运送客流累计数

**请求参数**

无

**返回**
​	
	//直接返回运送客流累计，格式为数值非json对象，如
	258000

### 3.2.5司机投入
按集团、公司显示司机投入实际/计划情况，提供百分比指数。

**请求参数**

无

**返回**

	[
		//集团排在集合第一行，其它公司按名称升序排列
		{
			"name":"集团或公司名称 如集团、一公司、二公司",
			"plan":"计划",
			"actual":"实际",
			"ratio":"百分比指数 数值不带%"
		}...
	]

### 3.2.6调度员投入
按集团、公司显示调度员投入实际/计划情况，提供百分比指数。

**请求参数**

无

**返回**

	[
		//集团排在集合第一行，其它公司按名称升序排列
		{
			"name":"集团或公司名称 如集团、一公司、二公司",
			"plan":"计划",
			"actual":"实际",
			"ratio":"百分比指数 数值不带%"
		}...
	]

### 3.2.7现场管理投入
按集团、公司显示现场管理上岗投入实际/计划情况，提供百分比指数。

**请求参数**

无

**返回**

```
[
	//集团排在集合第一行，其它公司按名称升序排列
	{
		"name":"集团或公司名称 如集团、一公司、二公司",
		"plan":"计划",
		"actual":"实际",
		"ratio":"百分比指数 数值不带%"
	}...
]
```

### 3.2.8停车场管理
按停车场名依次轮询显示停车场相关情况。

**停车场名称**

显示当前数据归属的停车场名称。

**报到情况**

包含当前报到准点率、计划数、实际数、待报到数、未报到数。

**出场情况**

包含当前出场准点率、计划数、实际数、待出场数、未出场数。

**场内停车情况**

包含当前场内停车数量，以及故障、小修、保养、留交数量。

**请求参数**

无

**返回**

	[
		{
			"name":"停车场名称",
			//报道
			"checkin":{
				"onTimeRatio":"准点率",
				"plan":"计划数",
				"actual":"实际数",
				"pending":"待报道数",
				"undone":"未报道数"
			},
			//出场情况
			"out":{
				"onTimeRatio":"准点率",
				"plan":"计划数",
				"actual":"实际数",
				"pending":"待出场数",
				"undone":"未出场数"
			},
			//场内停车情况
			"parking":{
				"parkingCount":"场内停车数",
				"fault":"故障数",
				"minorRepair":"小修数",
				"maintenance":"保养数",
				"retention":"留交数"
			}
		}...
	]

### 3.2.9到站预报准确率
显示各公司站点预报准确率情况。
>营运公司

>线路数	公司营运线路数

>准确率	综合准确率

>变化趋势 上升、下降、持平

>准确率分布

>>准确率数值范围 如90-100% 字符串描述

>>在此范围内的线路数 如67，表示有67条线路的预报准确率在此范围内

**请求参数**

无

**返回**


	//明细 集团排在集合第一行，其它公司按公司名升序排列
	[
		{
			"name":"名称、如集团、一公司、二公司",
			"lines":"线路数",
			"accuracy":"准确率",
			"upDown":"变化趋势 上升:1,下降:-1,持平:0",
			//分布性，此处用集合方便应对分布范围调整，当统计的分布范围做调整时接口格式不用变动，能自适应和自描述
			"distribution":[
				{
					"range":"准确率范围",
					"lines":"线路数"
				}...	
			],
		}...
	]


### 3.2.10指挥中心人员情况
显示集团以及下属指挥中心人员上岗情况（实际/计划），以及当前当值指挥长姓名。

**请求参数**

无

**返回**

	{
		"commander":"指挥长",
		"groupPlan":"集团计划",
		"groupAct":"集团实际",
		//各分指挥中心情况
		"list":[
			{
				"name":"分指挥中心名称",
				"commander":"分指挥中心指挥长",
				"plan":"计划数",
				"act":"实际数"
			}
		]
	}

## 3.3营运全过程
该部分主要为两小时工作交接汇报内容，主要为基于汇报机制，根据报告时间节点显示报告内容，以及提供数据下钻功能。

整体版面结构为统一框架设计：时间轴、公司级数据、车队级数据、线路级数据。

**时间轴**

时间轴依据目前汇报机制定，系统依据真实时间进行时间轴交互变化。目前两小时汇报机制起止时间点为7:30-22:30，间隔为2小时（最后一个时间点为1小时间隔），总计9次汇报时间。

默认情况下，时间轴根据当前实际时间，凸显所在汇报时间区域，并显示当前时间段的汇报内容。如果手动选择时间，可用鼠标点击相应的时间点图标，被选图标亮起，并显示该时间段的汇报内容。
注：未到时间的汇报时间点图标无法选择。

**时间段数据内容**

公司、车队、线路级别数据设计选择交互，默认显示一公司、一车队以及一车队线路明细。根据用户选择，切换显示目标公司、目标车队以及目标车队线路的明细数据。

### 3.3.1 7:30汇报
**汇报指标**

首班车准点率、出场准点率。

#### 3.3.1.1公司内容

集团和公司级的首班车准点率、出场准点率。集团数据排在集合第一行，其它公司按名称升序排列。

**请求参数**

无请求参数时。

**返回**

```
[
	{
		"name":"集团或公司名称",
		"companyCode":"公司编码 集团时编码可为空",
		"firstShiftRatio":"首末班准点率",
		"outRatio":"出场准点率"
	}...
]
```

#### 3.3.1.2车队内容

被选公司的车队级的首班车准点率、出场准点率。

**请求参数**

| 参数          | 是否必填 | 格式    | 说明                      |
| ----------- | ---- | ----- | ----------------------- |
| companyCode | 是    | 00-01 | 公司编码，提交此参数返回该公司下所有车队级信息 |

**返回**

```
	[
		{
			"name":"车队名称",
			"branchCode":"车队编码",
			"firstShiftRatio":"首末班准点率",
			"outRatio":"出场准点率"
		}...
	]
```

#### 3.3.1.3线路内容

被选公司、车队的线路级的首班车准点率（站牌）、出场准点率明细。（数据填写为：首行为车队指标，以下为线路指标。）字段为： 

- 序号
- 线路
- 首班车准点率（站牌）
  - 计划数
     实际数	
  - 准点率 
- 出场准点率
  - 计划数
  - 实际数
  - 准点率

**请求参数**

无请求参数时，默认返回集团和公司级的数据，集团排在集合第一行

| 参数          | 是否必填 | 格式       | 说明                      |
| ----------- | ---- | -------- | ----------------------- |
| companyCode | 否    | 00-01    | 公司编码，提交此参数返回该公司下所有车队级信息 |
| branchCode  | 是    | 00-01-01 | 车队编码，提交此参数返回该车队下所有线路级信息 |

**返回**


	[
		{
			"name":"车队或线路名称",
			"firstShift":{
				"plan":"首班车计划数",
				"actual":"首班车实际数",
				"ratio":"首班车准点率"
			},
			"outParking":{
				"plan":"出场计划数",
				"actual":"出场实际数",
				"ratio":"出场准点率"
			}
		}...
	]
### 3.3.2 9:30和19:30汇报
9:30 早高峰汇报，19:30 晚高峰汇报 数据时段不同格式相同，合并在一起。

**汇报指标**

早晚高峰出车率、早晚高峰班次率。

#### 3.3.2.1 公司内容

集团和公司级的早高峰出车率、早高峰班次率。集团数据排在集合第一行，其它公司按名称升序排列。

**请求参数**

| 参数             | 是否必填 | 格式        | 说明                                       |
| -------------- | ---- | --------- | ---------------------------------------- |
| collectionName | 是    | 3_3_2_1_* | 早高峰：请求参数为 3_3_2_1_1。<br>晚高峰：请求参数为 3_3_2_1_2。 |

**返回**

```
[
	{
		"name":"集团",
		"companyCode":"公司编码 集团时编码可为空",
		"departRatio":"早晚高峰出车率",
		"shiftRatio":"早晚高峰班次完成率"
	}, {
		"name":"巴士一公司",
		"companyCode":"公司编码 集团时编码可为空",
		"departRatio":"早晚高峰出车率",
		"shiftRatio":"早晚高峰班次完成率"
	}...
]
```

#### 3.3.2.2 车队内容

被选公司的车队级的早高峰出车率、早高峰班次率。

**请求参数**

| 参数             | 是否必填 | 格式        | 说明                                       |
| -------------- | ---- | --------- | ---------------------------------------- |
| companyCode    | 是    | 00-01     | 公司编码，提交此参数返回该公司下所有车队级信息                  |
| collectionName | 是    | 3_3_2_2_* | 早高峰：请求参数为 3_3_2_2_1。<br>晚高峰：请求参数为 3_3_2_2_2。 |

**返回**

```
	[
		{
			"name":"车队名称1",
			"branchCode":"车队编码1",
			"departRatio":"早晚高峰出车率",
			"shiftRatio":"早晚高峰班次完成率"
		}, {
			"name":"车队名称2",
			"branchCode":"车队编码2",
			"departRatio":"早晚高峰出车率",
			"shiftRatio":"早晚高峰班次完成率"
		}...
	]
```

#### 3.3.2.3 线路内容

被选公司、车队的线路级的早高峰出车、早高峰班次明细。（数据填写为：首行为车队指标，以下为线路指标。）字段为：

- 序号
- 线路
- 早晚高峰出车
  - 计划数
  - 实际数
  - 完成率
- 早晚高峰班次
  - 计划数
  - 实际数
  - 完成率

**请求参数**

返回线路级的数据，车队统计数据返回在集合第一行

| 参数             | 是否必填 | 格式        | 说明                                       |
| -------------- | ---- | --------- | ---------------------------------------- |
| branchCode     | 是    | 00-01-01  | 车队编码，提交此参数返回该车队下所有线路级信息                  |
| collectionName | 是    | 3_3_2_3_* | 早高峰：请求参数为 3_3_2_3_1。<br>晚高峰：请求参数为 3_3_2_3_2。 |
| companyCode    | 否    | 00-01     | 公司编码                                     |

**返回**

	//参数为branchCode时 返回，车队统计数据返回在集合第一行
		[
			{
				"name":"车队",
				"depart":{
					"plan":"出车计划数",
					"actual":"出车实际数",
					"ratio":"出车率"
				},
				"shift":{
					"plan":"班次计划",
					"actual":"班次实际",
					"ratio":"班次完成率"
				}
			}, {
				"name":"车队或线路名称1",
				"depart":{
					"plan":"出车计划数",
					"actual":"出车实际数",
					"ratio":"出车率"
				},
				"shift":{
					"plan":"班次计划",
					"actual":"班次实际",
					"ratio":"班次完成率"
				}
			}...
		]

### 3.3.3 11:30、21:30 汇报
11:30、21:30大间隔、车辆异常汇报，2次汇报的数据时段范围不同、格式相同，合并在一起

**汇报指标**

大间隔数、车辆异常数。

#### 3.3.3.1 公司内容

集团和公司级的大间隔数、车辆异常数。集团数据排在集合第一行，其它公司按名称升序排列。

**请求参数**

返回集团和公司级的数据，集团排在集合第一行。

| 参数             | 是否必填 | 格式        | 说明                                       |
| -------------- | ---- | --------- | ---------------------------------------- |
| collectionName | 是    | 3_3_3_1_* | 11:30 时，请求参数为 3_3_3_1_1。<br>21:30 时，请求参数为 3_3_3_1_2。 |

**返回**

```
//无参数时 返回
[
	{
		"name":"集团",
		"companyCode":"",
		"largeIntervalCt":"大间隔数",
		"abnormalCt":"异常数"
	}, {
		"name":"巴士一公司",
		"companyCode":"00-01",
		"largeIntervalCt":"大间隔数",
		"abnormalCt":"异常数"
	}...
]
```

#### 3.3.3.2 车队内容

被选公司的车队级的大间隔数、车辆异常数。车队按名称排序。

**请求参数**

返回车队级的数据。

| 参数             | 是否必填 | 格式        | 说明                                       |
| -------------- | ---- | --------- | ---------------------------------------- |
| collectionName | 是    | 3_3_3_2_* | 11:30 时，请求参数为 3_3_3_2_1。<br>21:30 时，请求参数为 3_3_3_2_2。 |
| companyCode    | 是    | 00-01     | 公司编码，提交此参数返回该公司下所有车队级信息                  |

**返回**

```
//参数含companyCode时 返回
	[
		{
			"name":"车队名称1",
			"branchCode":"车队编码1",
			"largeIntervalCt":"大间隔数",
			"abnormalCt":"异常数"
		}, {
			"name":"车队名称2",
			"branchCode":"车队编码2",
			"largeIntervalCt":"大间隔数",
			"abnormalCt":"异常数"
		}...
	]
```

#### 3.3.3.3 线路内容

被选公司、车队的线路级的大间隔数（截止到11点、15点-21点）、车辆非正常行驶（截止到11点、15点-21点）。（数据填写为：首行为车队指标，以下为线路指标。）字段为：

- 序号
- 线路
- 大间隔数
  - 实际执行班次数
  - 大间隔数
  - 大间隔发生率
- 车辆非正常行驶
  - 总次数
  - 事故
  - 故障
  - 纠纷
  - 其他

**请求参数**

返回线路级的数据，车队排在集合第一行

| 参数             | 是否必填 | 格式        | 说明                                       |
| -------------- | ---- | --------- | ---------------------------------------- |
| collectionName | 是    | 3_3_3_3_* | 11:30 时，请求参数为 3_3_3_3_1。<br>21:30 时，请求参数为 3_3_3_3_2 |
| companyCode    | 否    | 00-01     | 公司编码，提交此参数返回该公司下所有车队级信息                  |
| branchCode     | 是    | 00-01-01  | 车队编码，提交此参数返回该车队下所有线路级信息                  |

**返回**

	//车队统计数据返回在集合第一行
		[
			{
				"name":"车队或线路名称",
				"largeInterval":{
					"shift":"实际班次数",
					"inerval":"大间隔数",
					"ratio":"大间隔发生率"
				},
				"abnormal":{
					"count":"异常总数",
					"accident":"事故数",
					"fault":"故障数",
					"dispute":"纠纷数",
					"other":"其他异常数"
				}
			}...
		]
### 3.3.4 13:30汇报

**汇报指标**

大间隔数、车辆异常数、准点加入率。

#### 3.3.4.1 公司内容

集团和公司级的大间隔数、车辆异常数、准点加入率。集团数据排在集合第一行，其它公司按名称升序排列。

**请求参数**

无。

**返回**

```
//无参数CompanyCode和branchCode时 返回
[
	{
		"name":"集团名称",
		"companyCode":"集团时编码可为空",
		"largeIntervalCt":"大间隔数",
		"abnormalCt":"异常数",
		"joinRatio":"准点加入率"
	}, {
		"name":"公司名称1",
		"companyCode":"公司编码1",
		"largeIntervalCt":"大间隔数",
		"abnormalCt":"异常数",
		"joinRatio":"准点加入率"
	}...
]
```

#### 3.3.4.2 车队内容

被选公司的车队级的大间隔数、车辆异常数、准点加入率。按车队名称排序。

**请求参数**

返回车队级的数据。

| 参数          | 是否必填 | 格式    | 说明                      |
| ----------- | ---- | ----- | ----------------------- |
| companyCode | 是    | 00-01 | 公司编码，提交此参数返回该公司下所有车队级信息 |

**返回**

```
	[
		{
			"name":"车队名称1",
			"branchCode":"车队编码1",
			"largeIntervalCt":"大间隔数",
			"abnormalCt":"异常数",
			"joinRatio":"准点加入率"
		}, {
			"name":"车队名称2",
			"branchCode":"车队编码2",
			"largeIntervalCt":"大间隔数",
			"abnormalCt":"异常数",
			"joinRatio":"准点加入率"
		}...
	]
```

#### 3.3.4.3 线路内容

被选公司、车队的线路级的大间隔数（11点-13点）、车辆非正常行驶（11点-13点）。（数据填写为：首行为车队指标，以下为线路指标。）字段为：

- 序号
- 线路
- 大间隔数（11点-13点）
  - 实际执行班次数
  - 大间隔数
  - 大间隔发生率
- 车辆非正常行驶（11点-13点）
  - 总次数
  - 事故
  - 故障
  - 纠纷
  - 其他
- 准点加入率


**请求参数**

返回线路级的数据，车队排在集合第一行。

| 参数         | 是否必填 | 格式       | 说明                      |
| ---------- | ---- | -------- | ----------------------- |
| branchCode | 是    | 00-01-01 | 车队编码，提交此参数返回该车队下所有线路级信息 |

**返回**

	//参数为branchCode时 返回，车队统计数据返回在集合第一行
		[
			{
				"name":"车队名称",
				"largeInterval":{
					"shift":"实际班次数",
					"inerval":"大间隔数",
					"ratio":"大间隔发生率"
				},
				"abnormal":{
					"count":"异常总数",
					"accident":"事故数",
					"fault":"故障数",
					"dispute":"纠纷数",
					"other":"其他异常数"
				}
			}, {
				"name":"线路名称",
				"largeInterval":{
					"shift":"实际班次数",
					"inerval":"大间隔数",
					"ratio":"大间隔发生率"
				},
				"abnormal":{
					"count":"异常总数",
					"accident":"事故数",
					"fault":"故障数",
					"dispute":"纠纷数",
					"other":"其他异常数"
				}
			}...
		]


### 3.3.5 15:30汇报
**汇报指标**

车辆异常数、调度员签到率。

#### 3.3.5.1 公司内容

集团和公司级的车辆异常数、调度员签到率。

**请求参数**

无。返回集团和公司级的数据，集团排在集合第一行。

**返回**

```
//无参数 返回
[
	{
		"name":"集团或公司名称",
		"companyCode":"公司编码 集团时编码可为空",
		"abnormalCt":"异常数",
		"dispCheckRatio":"调度员签到率"
	}...
]
```

#### 3.3.5.2 车队内容

被选公司的车队级的车辆异常数、调度员签到率。按车队名称排序。

**请求参数**

返回车队级的数据。

| 参数          | 是否必填 | 格式    | 说明                      |
| ----------- | ---- | ----- | ----------------------- |
| companyCode | 是    | 00-01 | 公司编码，提交此参数返回该公司下所有车队级信息 |

**返回**

```
//参数为companyCode时 返回
	[
		{
			"name":"车队名称",
			"branchCode":"车队编码",
			"largeIntervalCt":"大间隔数",
			"abnormalCt":"异常数",
			"dispCheckRatio":"调度员签到率"
		}...
	]
```

#### 3.3.5.3 线路内容

被选公司、车队的线路级的车辆非正常行驶（13点-15点）、调度员签到明细。（数据填写为：首行为车队指标，以下为线路指标。）字段为：

- 序号
- 线路
- 车辆非正常行驶（13点-15点）
  - 总次数
  - 事故
  - 故障
  - 纠纷
  - 其他
- 调度员签到明细
  - 计划
  - 实际
  - 签到率

**请求参数**

返回线路级的数据，车队排在集合第一行。

| 参数         | 是否必填 | 格式       | 说明                      |
| ---------- | ---- | -------- | ----------------------- |
| branchCode | 是    | 00-01-01 | 车队编码，提交此参数返回该车队下所有线路级信息 |

**返回**

	//参数为branchCode时 返回，车队统计数据返回在集合第一行
		[
			{
				"name":"车队或线路名称",
				"abnormal":{
					"count":"异常总数",
					"accident":"事故数",
					"fault":"故障数",
					"dispute":"纠纷数",
					"other":"其他异常数"
				},
				//调度员签到
				"dispCheck":{
					"plan":"计划数",
					"actual":"实际数",
					"ratio":"签到率"
				}
			}...
		]

### 3.3.6 17:30汇报
**汇报指标**

车辆异常数、超速次数。

#### 3.3.6.1 公司内容

集团和公司级的车辆异常数、超速次数。

**请求参数**

无。返回集团和公司级的数据，集团排在集合第一行。

**返回**

```
//无参数返回
[
	{
		"name":"集团或公司名称",
		"companyCode":"公司编码 集团时编码可为空",
		"abnormalCt":"异常数",
		"overSpeedCt":"超速次数"
	}...
]
```

#### 3.3.6.2 车队内容

被选公司的车队级的车辆异常数、超速次数。按车队名称排序。

**请求参数**

返回车队级的数据。

| 参数          | 是否必填 | 格式    | 说明                      |
| ----------- | ---- | ----- | ----------------------- |
| companyCode | 是    | 00-01 | 公司编码，提交此参数返回该公司下所有车队级信息 |

**返回**

```
//参数为companyCode时 返回
	[
		{
			"name":"车队名称",
			"branchCode":"车队编码",
			"largeIntervalCt":"大间隔数",
			"abnormalCt":"异常数",
			"overSpeedCt":"超速次数"
		}...
	]
```

#### 3.3.6.3 线路内容

被选公司、车队的线路级的车辆非正常行驶（15点-17点）、超速（截止到17点）明细。（数据填写为：首行为车队指标，以下为线路指标。）字段为：

- 序号
- 线路
- 车辆非正常行驶（15点-17点）
  - 总次数
  - 事故
  - 故障
  - 纠纷
  - 其他
- 超速（截止到17点）
  - 最高车速
  - 最长时长
  - 标准
  - 次数
  - 车辆数
  - 车号


**请求参数**

返回线路级的数据，车队排在集合第一行。

| 参数          | 是否必填 | 格式       | 说明                      |
| ----------- | ---- | -------- | ----------------------- |
| companyCode | 是    | 00-01    | 公司编码                    |
| branchCode  | 是    | 00-01-01 | 车队编码，提交此参数返回该车队下所有线路级信息 |

**返回**

	//参数为branchCode时 返回，车队统计数据返回在集合第一行
		[
			{
				"name":"车队或线路名称",
				"abnormal":{
					"count":"异常总数",
					"accident":"事故数",
					"fault":"故障数",
					"dispute":"纠纷数",
					"other":"其他异常数"
				},
				"overSpeed":{
					"highSpeed":"计划数",
					"longTime":"实际数",
					"stdSpeed":"签到率",
					"overCount":"超速次数",
					"vCount":"车辆数",
					"vno":"车辆编号"
				}
			}...
		]


### 3.3.7 22:30汇报
**汇报指标**

大间隔数、车辆异常数、进场准点率。

#### 3.3.7.1 公司内容

集团和公司级的大间隔数、车辆异常数、进场准点率。集团数据排在集合第一行，其它公司按名称升序排列。

**请求参数**

无

**返回**
返回集团和公司级的数据，集团排在集合第一行。

```
[
	{
		"name":"集团",
		"companyCode":"",
		"largeIntervalCt":"大间隔数",
		"abnormalCt":"异常数",
		"inOntimeRat":"进场准点率"
	}, {
		"name":"巴士一公司",
		"companyCode":"00-01",
		"largeIntervalCt":"大间隔数",
		"abnormalCt":"异常数",
		"inOntimeRat":"进场准点率"
	}...
]
```

#### 3.3.7.2 车队内容

被选公司的车队级的大间隔数、车辆异常数、进场准点率。车队按名称排序。

**请求参数**

返回车队级的数据。

| 参数          | 是否必填 | 格式    | 说明                      |
| ----------- | ---- | ----- | ----------------------- |
| companyCode | 是    | 00-01 | 公司编码，提交此参数返回该公司下所有车队级信息 |

**返回**

```
//参数含companyCode时 返回
	[
		{
			"name":"车队名称1",
			"branchCode":"车队编码1",
			"largeIntervalCt":"大间隔数",
			"abnormalCt":"异常数",
			"inOntimeRat":"进场准点率"
		}, {
			"name":"车队名称2",
			"branchCode":"车队编码2",
			"largeIntervalCt":"大间隔数",
			"abnormalCt":"异常数",
			"inOntimeRat":"进场准点率"
		}...
	]
```

#### 3.3.7.3 线路内容

被选公司、车队的线路级的大间隔数（21点-22点）、车辆非正常行驶（21点-22点）。（数据填写为：首行为车队指标，以下为线路指标。）字段为：

- 序号
- 线路
- 大间隔数
  - 实际执行班次数
  - 大间隔数
  - 大间隔发生率
- 车辆非正常行驶
  - 总次数
  - 事故
  - 故障
  - 纠纷
  - 其他

**请求参数**

返回线路级的数据，车队排在集合第一行

| 参数          | 是否必填 | 格式       | 说明                      |
| ----------- | ---- | -------- | ----------------------- |
| companyCode | 否    | 00-01    | 公司编码，提交此参数返回该公司下所有车队级信息 |
| branchCode  | 是    | 00-01-01 | 车队编码，提交此参数返回该车队下所有线路级信息 |

**返回**

	//车队统计数据返回在集合第一行
	[
		{
			"name":"车队或线路名称",
			"largeInterval":{
				"shift":"实际班次数",
				"inerval":"大间隔数",
				"ratio":"大间隔发生率"
			},
			"abnormal":{
				"count":"异常总数",
				"accident":"事故数",
				"fault":"故障数",
				"dispute":"纠纷数",
				"other":"其他异常数"
			}
		}...
	]


## 3.4重点线路指标
列表显示一、三类线路重要指标，一类和三类拼成一张表区域显示，一、三类线路指标统计表按键切换一、三类。

显示集团、公司统计数值。标示数据更新时间。
### 3.4.1一类线路指标统计表
一类线路指标统计列表，集团数据在集合第一行，公司按名称升序排列

**指标类别包含**

线路数量、早高峰出车率、晚高峰出车率、早高峰班次完成率、晚高峰班次完成率、营业公里完成率、大间隔发生率。

营业公里完成率暂无指标明细

**请求参数**

无

**返回**

	{
		"updateTime":"更新时间 如2019年4月15日 09:00",
		"list":[
			{
				"company":"集团或公司名称",
				"linesCount":"线路数",
				"earlyDepartRat":"早高峰出车率",
				"lateDepartRat":"晚高峰出车率",
				"earlyShiftRat":"早高分班次完成率",
				"lateShiftRat":"晚高峰班次完成率",
				"operationKMRat":"营运公里完成率",
				"largeInternalRat":"大间隔发生率"
			}...
		]
	}


### 3.4.2三类线路指标统计表
三类线路指标统计列表，集团数据在集合第一行，公司按名称升序排列

**指标类别包含**

全日出车、全日班次、大间隔

**请求参数**

无

**返回**

	{
		"updateTime":"更新时间 如2019年4月15日 09:00",
		"list":[
			{
				"company":"集团或公司名称",
				"linesCount":"线路数",
				"departRat":"全日出车率",
				"shiftRat":"全日班次完成率",
				"outPlanRat":"计划外区间发生率",
				"largeInternalRat":"大间隔发生率",
				"firstLastOntimeRat":"首末班车准点率",
				"startOntimeRat":"起讫站发车准点率"
			}...
		]
	}


### 3.4.3早高峰出车、晚高峰出车（一类线路）指标明细表 
点击一、三类指标统计表中某公司某一项指标数值，指标明细表显示该公司下属线路此指标的明细。

一、三类指标统计表中，集团所在的行不可点击。

缺省出车 、情况说明字段、未操作 如有发生(大于 0) 字体用红色

数据填写首行为“合计”，其次为车队线路

**字段包含**

序号、车队、线路、计划出车、实际出车、缺损出车、情况说明（缺人、特约、缺车、纠纷、路阻、肇事、故障、保养、跨线、提前加入、调度员未规范操作、其他）、未操作。

**请求参数**

| 参数          | 是否必填 | 格式    | 说明                    |
| ----------- | ---- | ----- | --------------------- |
| companyCode | 是    | 00-01 | 公司编码，提交此参数返回该公司下属线路数据 |
| type        | 是    | 1     | 早高峰: 1, 晚高峰: 2        |

**返回**

	[
		{
			"idx":"序号",
			"branch":"车队",
			"line":"线路名",
			"plan":"计划出车",
			"actual":"实际出车",
			"lack":"缺损出车",
			"lackStaff":"缺人",
			"special":"特约",
			"lackBus":"缺车",
			"dispute":"纠纷",
			"resistance":"路阻",
			"trouble":"肇事",
			"fault":"故障",
			"maintain":"保养",
			"crossLine":"跨线",
			"earlyJoin":"提前加入",
			"dispViolate":"调度员未规范操作",
			"other":"其他",
			"undone":"未操作"
		}...	
	]


### 3.4.4早高峰班次、晚高峰班次（一类线路）指标明细表 
缺损班次 、情况说明字段、未操作 如有发生(大于 0) 字体用红色

数据填写首行为“合计”，其次为车队线路。

**字段包含**

序号、车队、线路、计划班次、实际班次、缺损班次、情况说明（缺人、特约、缺车、纠纷、路阻、肇事、故障、保养、跨线、调度员未规范操作、其他）、未操作。

**请求参数**

| 参数          | 是否必填 | 格式    | 说明                    |
| ----------- | ---- | ----- | --------------------- |
| companyCode | 是    | 00-01 | 公司编码，提交此参数返回该公司下属线路数据 |
| type        | 是    | 1     | 早高峰: 1, 晚高峰: 2        |

**返回**

	[
		{
			"idx":"序号",
			"branch":"车队",
			"line":"线路名",
			"plan":"计划班次",
			"actual":"实际班次",
			"lack":"缺损班次",
			"lackStaff":"缺人",
			"special":"特约",
			"lackBus":"缺车",
			"dispute":"纠纷",
			"resistance":"路阻",
			"trouble":"肇事",
			"fault":"故障",
			"maintain":"保养",
			"crossLine":"跨线",
			"dispViolate":"调度员未规范操作",
			"other":"其他",
			"undone":"未操作"
		}...	
	]


### 3.4.5大间隔（一类线路、三类线路）指标明细表 
大间隔 、情况说明字段、未操作 如有发生(大于 0) 字体用红色

数据列表首行为“合计”，其次为车队线路。

**字段包含**

序号、车队、线路、实际班次、大间隔、发生率、情况说明（缺人、特约、缺车、纠纷、路阻、肇事、故障、调度员未规范操作、其他）、未操作。

**请求参数**

| 参数          | 是否必填 | 格式    | 说明                    |
| ----------- | ---- | ----- | --------------------- |
| companyCode | 是    | 00-01 | 公司编码，提交此参数返回该公司下属线路数据 |
| type        | 是    | 1     | 一类线路: 1, 三类线路: 2      |

**返回**

	[
		{
			"idx":"序号",
			"branch":"车队",
			"line":"线路名",
			"actual":"实际班次",
			"largeInternal":"大间隔",
			"ratio":"发生率",
			"lackStaff":"缺人",
			"special":"特约",
			"lackBus":"缺车",
			"dispute":"纠纷",
			"resistance":"路阻",
			"trouble":"肇事",
			"fault":"故障",
			"dispViolate":"调度员未规范操作",
			"other":"其他",
			"undone":"未操作"
		}...	
	]


### 3.4.6全日出车（三类线路）指标明细表 
缺损出车 、情况说明字段、未操作 如有发生(大于 0) 字体用红色

数据列表首行为“合计”，其次为车队线路。

**字段包含**

序号、车队、线路、计划出车、实际出车、缺损出车、情况说明（缺人、特约、缺车、纠纷、路阻、肇事、故障、保养、跨线、提前加入、调度员未规范操作、其他）、未操作。

**请求参数**

| 参数          | 是否必填 | 格式    | 说明                    |
| ----------- | ---- | ----- | --------------------- |
| companyCode | 是    | 00-01 | 公司编码，提交此参数返回该公司下属线路数据 |

**返回**

	[
		{
			"idx":"序号",
			"branch":"车队",
			"line":"线路名",
			"plan":"计划出车"
			"actual":"实际出车",
			"lack":"缺损出车",
			"lackStaff":"缺人",
			"special":"特约",
			"lackBus":"缺车",
			"dispute":"纠纷",
			"resistance":"路阻",
			"trouble":"肇事",
			"fault":"故障",
			"maintain":"保养",
			"crossLine":"跨线",
			"earlyJoin":"提前加入"
			"dispViolate":"调度员未规范操作",
			"other":"其他",
			"undone":"未操作"
		}...	
	]




### 3.4.7全日班次（三类线路）指标明细表 
缺损班次 、情况说明字段、未操作 如有发生(大于 0) 字体用红色

数据列表首行为“合计”，其次为车队线路。

**字段包含**

序号、车队、线路、计划班次、实际班次、缺损班次、情况说明（缺人、特约、缺车、纠纷、路阻、肇事、故障、保养、跨线、调度员未规范操作、其他）、未操作。

**请求参数**

| 参数          | 是否必填 | 格式    | 说明                    |
| ----------- | ---- | ----- | --------------------- |
| companyCode | 是    | 00-01 | 公司编码，提交此参数返回该公司下属线路数据 |

**返回**

	[
		{
			"idx":"序号",
			"branch":"车队",
			"line":"线路名",
			"plan":"计划班次"
			"actual":"实际班次",
			"lack":"缺损班次",
			"lackStaff":"缺人",
			"special":"特约",
			"lackBus":"缺车",
			"dispute":"纠纷",
			"resistance":"路阻",
			"trouble":"肇事",
			"fault":"故障",
			"maintain":"保养",
			"crossLine":"跨线",
			"dispViolate":"调度员未规范操作",
			"other":"其他",
			"undone":"未操作"
		}...	
	]



## 3.5安全管控

### 3.5.1客伤警报
当发生事故情况，且该事故出现客伤情况时，则在列表中挂起事故记录，并按汇报机制30分钟进行计时。如30分钟内公司指挥中心提交该事故详细报告单，则结束计时，显示提交耗时，并显示报告图标。点击图标可以浮窗显示该事故的报告单详情。如超出30分钟阈值要求，则计时红色提醒，并继续计时，直至报到提交到达。

表格记录字段包括：序号、公司、线路、车牌号、停驶时段、原因、简述、报告单。

**请求参数**

无

**返回**

```
{
	"total": "今日发生总数",
	"reported": "已投递报告数",
	"list": [{
		"idx": "序号",
		"company": "公司",
		"line": "线路",
		"licence": "车牌号",
		"stopTimeSlot": "停驶时段",
		"reason": "原因",
		"description": "简述",
		"occurrenceTime": "发生时间",
		"reportList": {
			"accidentSeverity": "事故严重程度",
			"serialNumber": "车辆自编号",
			"accidentTarget": "事故对象",
			"address": "事故地点",
			"driverInfo": {
				"name": "驾驶员姓名",
				"sex": "性别",
				"age": "年龄",
				"driving_age": "驾龄"
			},
			"casualtyInfo": [{
				"name": "伤亡者姓名",
				"sex": "性别",
				"age": "年龄",
				"address": "单位及住址"
			}...],
			"reportInfo": {
				"type": "事故类型",
				"overview": "简况",
				"rescue": "伤势及抢救措施",
				"date": "报告日期",
				"person": "报告人"
			}
		}
	}...]
}
```

### 3.5.2 DVR监控违规违操情况
该功能基于目前日常DVR巡检作业情况，进行实时汇总统计，显示抽检数量以及抽检结果情况。

**抽检统计**

按集团、公司统计当日截止当前时间段的抽检情况统计，包括：抽检线路条数、抽检车辆辆数、违规违操数、检出率。

**违规违操情况**

以列表情况详细清列违规违操检出的详情，区分类型以及公司归属。页面设计将检出类型分成安全方面和服务方面两部分，点击类型切换表单内容显示。

数据统计，异常类型数字着色红色。

**请求参数**

无

**返回**

返回集团和公司级的数据，集团排在集合第一行，其他公司按名称升序排列

```
{
	"sum":[
		{
			"company":"集团或公司名",
			"examineLines":"检查线路数",
			"examineBuses":"检查车辆数",
			"violation":"违规违操",
			"rate":"检出率  百分比数值 不带%"
		}...
	],
	"detail":[
		{
			"company":"集团或公司名称"
			"armband":"未佩戴臂章",
			"smoke":"行驶中抽烟",
			"phone":"行驶中使用手机",
			"unDoWork":"做与工作无关的事",
			"seatBelt":"未规范系安全带",
			"talk":"并岗闲谈",
			"handOff":"脱手操作",
			"footOnDash":"脚搁仪表盘",
			"laneChange":"违章变道",
			"brokeTrafficLight":"闯信号灯",
			"yieldHereToPeds":"斑马线未礼让行人",
			"examine":"未一程一检",
			"pullKey":"离车未拔钥匙",
			"closeDoor":"终点站停发未关车门",
			"otherSecurity":"其他安全违规",
			"dressCode":"未规范着装",
			"stationStop":"未停或未规范停站",
			"threeBusTwoStop":"未三车二停",
			"otherService":"其他服务违规"
		}...
	],
}
```



## 3.6 服务管控

### 3.6.1 服务热线

基于电话热线接听情况，进行热线信息登记情况统计。提供咨询类、建议类、意见类、其他类4类情况统计。

提供日热线情况分类曲线，显示每日热线反馈类型统计情况。

**请求参数**

无

**返回**

当天统计及当天起近一周的历史情况, 近一周历史按日期升序排列

```
{
	"today":{
		"advisory":"咨询",
		"suggestion":"建议",
		"opinion":"意见",
		"other":"其他"
	},
	"list":[
		{
			"date":"日期",
			"advisory":"咨询",
	   		"suggestion":"建议",
	    	"opinion":"意见",
	    	"other":"其他"
		}...
	]
}
```


### 3.6.2 舆情信息
当天舆情信息和近一周舆情历史数据，历史数据按日期升序排列

新闻媒体发布的涉及久事公交相关的舆情进行监控和统计，区分信息敏感度，显示占比情况和日记录曲线。同时显示舆情内容简述，以及标注舆情发布者名称、热度等信息。

目前久事公交指挥中心采用人工收听、收看媒体并登记的方式，今后可采用舆情监控服务购买并接入的方式，完善整体应用。

**请求参数**

无

**返回**

	{
		"today":[
			{
				"date":"日期时间 mm-dd HH:mm",
				"content":"舆情报道文字内容",
				"from":"舆情来源 报纸、网站等媒体名称",
				"hot":"热度指数"
			}...
		],
		//历史统计
		"list":[		
			{
				"date":"日期",
				"positive":"正面舆情数",
				"negative":"负面舆情数",
				"neutral":"中性舆情数"
			}...	
		]
	}

### 3.6.3 站点通、报到机、站点设施工作状态
返回集团和各营运公司 站点通、报到机、站点设施工作状态

**站点通工作状态**

按集团、公司统计设备部署总数，以及当前异常数。（异常数红色表示）

**报到机工作状态**

按集团、公司统计设备部署总数，以及当前异常数。（异常数红色表示）

**站点设施工作状态**

按集团、公司统计设备部署总数，以及当前异常数。（异常数红色表示）
设备指调度室内的PC机和网络。


**请求参数**

无

**返回**

	{
		//站点通
		"stationChain":[
			{
				"company":"集团或公司名称",
				"fault":"故障数",
				"total":"总数"
			}...
		],
		//报到机
		"checkInMachine":[
			{
				"company":"集团或公司名称",
				"fault":"故障数",
				"total":"总数"
			}...
		],
		//站点设施
		"terminalFacility":[
			{
				"company":"集团或公司名称",
				"fault":"故障数",
				"total":"总数"
			}...
		]
	}

### 3.6.4 电子站牌工作状态
电子站牌当前工作状态和近一周统计历史

按集团、公司统计设备部署总数（分电子站牌类型），以及当前异常数。（异常数红色表示）
提供设备日工作状态柱状统计图。

**请求参数**

无

**返回**

	{
		//当前
		"now":{
			"oledFault":"oled损坏数",
			"oledTotal":"oled总数",
			"lcdFault":"lcd损坏数",
			"lcdTotal":"lcd总数",
			"inkFault":"墨水屏损坏数",
			"inkTotal":"墨水屏总数"
		},
		//统计历史		
		"list":[
			{
				"date":"日期",
				"oledFault":"oled损坏数",
				"oledTotal":"oled总数",
				"lcdFault":"lcd损坏数",
				"lcdTotal":"lcd总数",
				"inkFault":"墨水屏损坏数",
				"inkTotal":"墨水屏总数"
			}
		]
	}

## 3.7 机务保障
### 3.7.1 车辆总体情况
- 统计当前在用车辆数
- 当前可用车辆数
- 封存车辆数
- 隔日留交车辆数
- 进场保养车辆数
- 维修中车辆数

**请求参数**

无

**返回**
​	
​	{
		"inUse":"在用车辆数",
	      "canUse":"当前可用车辆数",
		"seal":"封存车辆数",
		"retain":"隔日留交车辆数",
		"maintain":"进场保养车辆数",
		"repair":"维修车辆数"
	}

### 3.7.2 维修、保养、留交详细情况
**早出场报修情况**

提供当日早出场报修车辆修复完成率，以及提供具体报修数、竣工数、在修数

- 报修
- 竣工
- 在修

**车辆留交情况**

提供昨日留交总数，以及分类留交统计数。分类包括：肇事、厂方、车间。
提供各公司留交数和占比

- 肇事留交
- 厂方留交
- 车间留交
- 各公司留交数量

**集中抢修情况**

提供当日集中抢修情况接报累计统计，以及提供派单统计数和就近安排抢修数

- 接报数量
- 派单数
- 就近安排抢修数

**保养执行情况**

提供当日保养计划总数和单前执行总数比例情况，以及提供计划、报修、竣工、在修具体执行情况统计

- 计划
- 报修
- 在修
- 竣工

**小修执行情况**

提供当日当前小修完成率统计，并提供当日报修总数、竣工数、在修数统计

- 报修
- 在修
- 竣工

**请求参数**

无

**返回**

	{
		//早出场报修
		"repair":{
			"checkIn":"报修",
			"done":"竣工",
			"doing":"在修"
		},
		//车辆留交情况
		"retain":{
			"trouble":"肇事留交",
			"factorySide":"厂方留交",
			"workshop":"车间留交",
			//各公司留交数
			"list":[
				{
					"company":"公司名",
					"count":"数量"
				}...
			]
		},
		//集中抢修
		"rushRepair":{
			"checkIn":"接报数",
			"dispatched":"派单数",
			"nearby":"就近安排抢修数"
		},
		//保养执行
		"maintain":{
			"plan":"计划数",
			"checkIn":"报修数",
			"done":"竣工数",
			"doing":"在修数"
		},
		//小修执行情况
		"minorRepair":{
			"checkIn":"报修",
			"done":"竣工",
			"doing":"在修"
		}
	}

### 3.7.3 三天一覆盖执行情况
针对机务检查三天一覆盖原则，统计执行情况。清列一个循环检查周期每天的检查量比例，以及提供各公司覆盖比例情况。同时提供检查问题的汇总统计，包括问题总数以及分类统计数。分类包括：安全设施、电器电线、机械渗油、其他。

**集团和各营运公司三天一覆盖 覆盖率信息**

每天覆盖率 集合中第一行返回集团覆盖率，公司覆盖率按名称升序排列

**覆盖过程中检查问题统计**

**请求参数**

无

**返回**

	{
		//覆盖情况
		"examine":{
			"first":[
				{
					"company":"集团或公司名称",
					"rate":"覆盖率"
				}...
			],
			"second":[
				{
					"company":"集团或公司名称",
					"rate":"覆盖率"
				}...
			],
			"third":[
				{
					"company":"集团或公司名称",
					"rate":"覆盖率"
				}...
			],
		},
		//检查问题
		"trouble":{
			"total":"问题总数",
			"security":"安全问题",
			"electric":"电器电线",
			"oilSpill":"机械渗油",
			"other":"其他"
		}
	}

### 3.7.4 新能源车远程监控情况
提供当日三级报警信息统计数，以及其中需要紧急处理的数量。

扩展：点击项目，可以展开明细情况表。

**新能源车报警**

- 当日三级报警总数
- 当前待处理三级报警数

**请求参数**

无

**返回**

	{
		"lv3":"三级报警总数",
		"lv3Hang":"待处理数"
	}

## 3.8 场站保障
### 3.8.1 人员上岗
管理人员、保安人员、保洁人员 早上岗、晚上岗情况

**管理人员上岗**

对场站管理人员上岗情况进行统计，分早、晚显示上岗情况。统计类型包括上岗率、计划数和实际执行数。

早、晚统计时间未至时，显示上一个统计周期的数据结果，并灰色标注上岗率图示。

**保安、保洁人员上岗**

对场站内外包保安、保洁人员上岗情况进行统计，分早、晚显示上岗情况。统计类型包括上岗率、计划数和实际执行数。

早、晚统计时间未至时，显示上一个统计周期的数据结果，并灰色标注上岗率图示。

**请求参数**

无

**返回**
​	
	{
		//早上岗
		"am":{
			//管理人员上岗
			"manager":{
				"plan":"计划",
				"actual":"实际"
			},
			//保安人员上岗
			"security":{
				"plan":"计划",
				"actual":"实际"
			},
			//保洁人员上岗
			"cleaner":{
				"plan":"计划",
				"actual":"实际"
			}
		},
		//晚上岗
		"pm":{
			"manager":{
				"plan":"计划",
				"actual":"实际"
			},
			"security":{
				"plan":"计划",
				"actual":"实际"
			},
			"cleaner":{
				"plan":"计划",
				"actual":"实际"
			}
		}
	}

### 3.8.2 营运车辆进出场情况
对当日进出场情况进行统计，包括进出场车辆数以及出场无出门证情况、进场一车一检拒检情况。

**请求参数**

无

**返回**

	{
		//进场情况
		"in":{
			"busCt":"进场车辆总数",
			"refuseCheck":"一车一检拒检数"
		},
		//出场情况
		"out":{
			"busCt":"出场车辆总数",
			"noPass":"无出门证数"
		}
	}

### 3.8.3 设施设备、危险源、违章监控
设施设备、危险源、违章

无异常填报时，显示绿色标示。有异常填报时，显示红色异常标示，并显示当前异常信息条数。

**各字段数据类型为number >=0 , 有异常时填异常信息条数，无异常时为0**

**设施设备监控**

无异常填报时，显示绿色标示。有异常填报时，显示红色异常标示，并显示当前异常信息条数。
监控类型包括：场地设施设备、重要道路、消防通道情况。

**危险源监控**

无异常填报时，显示绿色标示。有异常填报时，显示红色异常标示，并显示当前异常信息条数。
监控类型包括：场地加油站、危化品库房外围、维修施工项目现场。

**场地违章监控**

无异常填报时，显示绿色标示。有异常填报时，显示红色异常标示，并显示当前异常信息条数。
监控类型包括：非机动车骑行。



**请求参数**

无

**返回**

	{
		//设施设备监控
		"facility":{
			"siteFacility":"场地设施设备 ,有异常时填异常信息条数 n，无异常时为 0",
			"importantRoad":"重要道路",
			"fireExits":"消防通道情况",
			"allSiteFacilityNum":"全部场地设施设备数量",
			"allImportantRoadNum":"全部道路数量",
			"allFireExitsNum":"全部消防通道数量"
		},
		//危险源监控
		"riskSource":{
			"siteGas":"场地加油站",
			"chemicalsOuter":"危化品库房外围",
			"constructionSite":"维修施工项目现场",
			"allSiteGas":"全部场地加油站",
			"aLLChemicalsOuter":"全部危化品库房外围",
			"allConstructionSite":"全部维修施工项目现场",
		},
		//场地违章监控
		"siteViolation":{
			"nonMotorRiding":"非机动车骑行"
		}
	}

### 3.8.4 节假日及重大活动情况汇报
提供节假日标注。（扩展：今后通过大型活动计划安排联动，可以显示当日有什么重大活动）

显示情况报告短消息流水信息，包括：时间、信息内容。（报平安内容使用绿色标示，报异常内容使用红色标示）

**请求参数**

无

**返回**

	{
		"date":"日期 yyyy-mm-dd",
		"bigEvent":"节假日或重大活动名称",
		//情况报告信息流水
		"list":[
			{
				"time":"时间 HH:mm",
				"msg":"消息描述",
				"type":"类型，正常汇报:0, 异常:1"
			}...
		]
	}

## 3.9 供电保障
### 3.9.1 抢修车配车情况、新能源充电站设备运行情况、新能源充电营运数据
>抢修车配车情况

抢修车总数(辆)、实际待命数(辆)、配车比率。
>新能源充电站设备运行情况

状态良好数(个)、状态不良数(个)、良好率。
>新能源充电营运数据

今日充电电量(度)、今日充电车辆(辆次)、累计减少排放(吨)、累计节油(升)。

**请求参数**

无。

**返回**

```
{
	"repairBus": {
		"repairBusNum": "55",
		"standbyNum": "46",
		"busRatio": "75%"
	},
	"chargingStation": {
		"fineNum": "596",
		"badNum": "30",
		"stationRatio": "95%"
	},
	"chargingData": {
		"ammeterCost": "32008",
		"chargingBus": "6800",
		"reduceEmissions": "596",
		"saveOil": "2000"
	}
}
```



### 3.9.2 电车架空线网、电车整流站设备运行情况

> 电车架空线网设备运行情况

> 电车整流站设备运行情况

**请求参数**

无。

**返回**

```
{
	"tramNetwork": {
		"siteFacility": "电车架空线网设施设备 ,有异常时填异常信息条数 n，无异常时为 0"
	},
	"tramStation": {
		"siteFacility": "电车整流站设施设备 ,有异常时填异常信息条数 n，无异常时为 0"
	}
}
```



### 3.9.3 车辆充电情况
> 充电情况曲线图

今日、上周同日(每隔半小时计算辆次总数、电量数)

> 今日充电分布圆形图

各充电停车场充电占比(辆次、电量数)


**请求参数**

无。

**返回**

```
{
	// 曲线图
	"chargingCurve": [{
		"hour": "00:30",
		"currentThis": {
			"busNum": "628",
			"electricity": "3600"
		},
		"currentLast": {
			"busNum": "528",
			"electricity": "3000"
		}
	}, {
		"hour": "01:00",
		"currentThis": {
			"busNum": "628",
			"electricity": "3600"
		},
		"currentLast": {
			"busNum": "528",
			"electricity": "3000"
		}
	}...],
	// 圆形图
	"chargingCircle": [{
		"name": "天山场",
		"ratio": "18%",
		"bus": "200",
		"ammeter": "5300"
	}, {
		"name": "沪太场",
		"ratio": "10%",
		"bus": "120",
		"ammeter": "2700"
	}...]
}
```



### 3.9.4 重大突发情况

倒序排列。

**请求参数**

无。

**返回**

```
[{
	"time": "10:00",
	"msg": "宝杨路停车场道路施工事故导致临时停电，预计10:30修复"
}, {
	"time": "09:45",
	"msg": "双流路停车场道路施工事故导致临时停电，预计10:00修复"
}]
```




# 4 云指挥
## 4.1 指挥首页
### 4.1.1 应急方案模块
#### 4.1.1.1 应急方案列表清单

展示所有应急预案信息，分为5大类：突发事件(1) 、大型赛事(2) 、大型活动(3) 、轨迹支援(4) 、过江支援(5)  。

包含各分类下的计划清单。

**请求参数**

| 参数   | 是否必填 | 格式   | 说明     |
| ---- | ---- | ---- | ------ |
| type | 否    | 1    | 应急方案类型 |

**返回**

```
[{
	"type": "1",
	"programmeName": "突发事件",
	"supportList": [{
		"itemId":"5CC192AD72F15C87E0531F2C220A8699",
		"itemName": "突发事件计划1",
		"status": "启动",
		"lineNum": "20",
		"busNum": "312/210/102",
		"joinOrg": "巴士一公司,巴士二公司,巴士三公司"
	}...]
}, {
	"type": "2",
	"programmeName": "大型赛事",
	"supportList": [{
		"itemId":"5CC192AD72F15C87E0531F2C220A8699",
		"itemName": "大型赛事计划1",
		"status": "启动",
		"lineNum": "20",
		"busNum": "312/210/102",
		"joinOrg": "巴士一公司,巴士二公司,巴士三公司"
	}...]
}...]
```



#### 4.1.1.2 单笔应急方案的线路清单(常规公交、轨交应急)

展示单笔应急方案计划的线路配置，包含：常规公交线路信息，轨交应急线路信息。

**请求参数**

| 参数     | 是否必填 | 格式                               | 说明       |
| ------ | ---- | -------------------------------- | -------- |
| itemId | 是    | 5CC192AD72F15C87E0531F2C220A8699 | 应急方案计划ID |

**返回**

```
{
	"itemId":"5CC192AD72F15C87E0531F2C220A8699",
	"itemName": "突发事件计划1",
	// 常规公交线路
	"lineNormal": [{
			"company": "巴士三公司",
			"branch": "一车队",
			"line": "112",
			"lineType": "常规公交线",
			"beOutBus": "16/16",
			"beShiftsNum": "55",
			"beginStation": "大华新村",
			"endStation": "人民广场(武胜路)",
			"status": "启动",
		}...],
	// 轨交应急线路
	"lineEmergency": [{
			"company": "巴士三公司",
			"branch": "一车队",
			"line": "1A",
			"lineType": "轨交应急线",
			"beOutBus": "16",
			"beginStation": "大华新村",
			"endStation": "人民广场(武胜路)",
			"status": "启动",
			"beginPoint":"121.32321,32.325678",
			"endPoint":"121.32301,32.325631"
		}...]
}
```



#### 4.1.1.3 线路配车明细

展示单笔应急方案计划的单条线路的配车信息。

**请求参数**

| 参数     | 是否必填 | 格式                               | 说明       |
| ------ | ---- | -------------------------------- | -------- |
| itemId | 是    | 5CC192AD72F15C87E0531F2C220A8699 | 应急方案计划ID |
| line   | 是    | 1A                               | 线路名称     |

**返回**

```
{
	"itemId": "5CC192AD72F15C87E0531F2C220A8699",
	"itemName": "突发事件计划1",
	"line": "1A",
	"busList": [{
		"busCode": "S2L-093G",
		"license": "沪A-97975",
		"busnum": "应急编号",
		"company": "公司",
		"locationTime": "2019-06-10 10:02:12"
	}, {
		"busCode": "S2L-093G",
		"license": "沪A-97975",
		"busnum": "应急编号",
		"company": "公司",
		"locationTime": "2019-06-10 10:02:12"
	}...]
}
```



#### 4.1.1.4 应急支援车辆明细

展示单笔应急方案计划的应急支援车辆的配车信息。

**请求参数**

| 参数     | 是否必填 | 格式                               | 说明       |
| ------ | ---- | -------------------------------- | -------- |
| itemId | 是    | 5CC192AD72F15C87E0531F2C220A8699 | 应急方案计划ID |

**返回**

```
{
 "itemId": "5CC192AD72F15C87E0531F2C220A8699",
 "list": [{
  "company": "集团全部",
  "allBusNum": "55",
  "workBusNum": "15",
  "busList": [{
   "busCode": "S2L-093G",
   "isWorked": "0"（未启动）
  }, {
   "busCode": "S2L-094G",
   "isWorked": "1"（启动）
  }]
 }, {
  "company": "巴士一公司",
  "allBusNum": "55",
  "workBusNum": "15",
  "busList": [{
   "busCode": "S2L-093G",
   "isWorked": "0"
  }, {
   "busCode": "S2L-094G",
   "isWorked": "1"
  }]
 }]
}
```



#### 4.1.1.5 应急预案线路起讫点及轨迹

所有预案线路起讫点及轨迹

**请求参数**

无

**返回**

```
[
  {
    "line": "线路名唯一 A线",
    "startName": "起点名",
    "startPoint": [经度,纬度],	
    "endName": "终点名",
    "endPoint": [经度,纬度],
    "trend": [
      {
        "direction": "方向 起程",
        //线路轨迹
        "coordinates": [[121.3075,31.18674], [121.30466,31.1859], [121.30462,31.1857]...]
      },
   		//如单开 则无回程 	  
      {
        "direction": "方向 回程",
        //线路轨迹
        "coordinates": [[121.3075,31.18674], [121.30466,31.1859], [121.30462,31.1857]...]
      }
    ]
	}
]
```



#### 4.1.1.6 线路班次

**请求参数**

| 参数 | 是否必填 | 格式 | 说明     |
| ---- | -------- | ---- | -------- |
| line | 是       | 1A   | 线路名称 |

**返回**

```
[
	//如线路有起程、回程2个方向 则有2个行驶方向的班次
  {
    "endStation":"上海火车站 开往终点站名",
    "list":[
    	{
    		"busCode": "S2L-093G",
				"license": "沪A-97975",
    		"busnum":"应急编号",
        "startTime":"发车时间",
        "endTime":"到达时间"
    	}...
    ]
  },
  {
    "endStation":"人民广场 开往终点站名",
    "list":[
    	{
    		"busCode": "S2L-093G",
				"license": "沪A-97975",
    		"busnum":"应急编号",
        "startTime":"发车时间",
        "endTime":"到达时间"
    	}...
    ]
  }
]
```



#### 4.1.1.7 现场管理人员上岗计划 

已启动预案上岗人员计划

**请求参数**

无

**返回**

```
[
	{
		"company":"公司",		
		"name":"姓名",				
		"job":"岗位任务描述 某个地点或跟车",
		"office":"职位",
		"radioCode":"电台编号",
    "itemName":"预案名"
	}...
]
```



#### 4.1.1.8 线路预案执行概况

指定线路预案进展情况和资源投入

- 预案进度 : 目前设定5个进度 启动、指挥中心(公司)、第一辆车出发、第一辆车到达、结束
  - 每个生效的进度对应有生效日期时间，未生效的进度日期时间为空字符串
  - 如以后客户需求有调整 （新设计进度或更改进度名称），只需对应插入进度到progress数组或更新对应进度名称描述即可
  - 第一辆车出发、第一辆车到达 两个状态中时间分 赶往起点方向时间、赶往终点方向时间
- 支援的公司
- 当前车辆投入总数及各公司投入数
- 总班次、起点方向班次、终点方向班次

**请求参数**

| 参数 | 是否必填 | 格式 | 说明     |
| ---- | -------- | ---- | -------- |
| line | 是       | 1A   | 线路名称 |

**返回**

```
{
	//预案进度 
	"progress":[
		{
			"status":"启动",
			"time":"05:00"
		},
		{
			"status":"指挥中心(公司)",
			"time":"05:30"
		},
		{
			"status":"第一辆车出发",
			//赶往起点方向时间
			"timeToBegin":"07:00",
			//赶往终点方向时间
			"timeToEnd":"07:00"
		},
		{
			"status":"第一辆车到达",
			//赶往起点方向时间
			"timeToBegin":"07:20",
			//赶往终点方向时间
			"timeToEnd":""			
		},
		{
			"status":"结束",
			"time":""
		}
	],
	//支援的公司
	"company":["一公司","二公司"],
	"busTotal":"车辆投入总数",
	"companyBus":[
		{
			"company":"公司名",
			"busCount":"车辆数"
		}...
	],
	"shiftTotal":"班次总数",
	"toStartShift":"开往起点班次",
	"toEndShift":"开往终点班次"
}
```



### 4.1.2 应急资源查询工具

#### 4.1.2.1 查询目标点附近起讫站及可调用车辆

**请求参数**

| 参数         | 是否必填 | 格式                             | 说明                      |
| ------------ | -------- | -------------------------------- | ------------------------- |
| itemId       | 是       | 5CC192AD72F15C87E0531F2C220A8699 | 应急方案计划ID            |
| line         | 是       | 1A                               | 线路名                    |
| beginStation | 是       | 人民广场                         | 起点名                    |
| beginPoint   | 是       | 121.32321,32.325678              | 起点经纬度                |
| beginRange   | 是       | 3                                | 起点搜索半径范围 单位公里 |
| endStation   | 是       | 上海火车站                       | 终点名                    |
| endPoint     | 是       | 121.32301,32.325631              | 终点经纬度                |
| endRange     | 是       | 2                                | 终点搜索半径范围 单位公里 |

**返回**

```
{
	"uid":"查找结果id 也是保存结果时的档案id",
	//起点信息
	"begin":{
    "companyNum":"涉及公司数",
    "officeNum":"涉及车队办公点数",
    "stationNum":"涉及起讫站数",
    "lineNum":"涉及线路数",
    "busNum":"涉及车辆数",
    "stations":[
      {
        "name":"站点名称",
        "lnglat":[经度,纬度],
        "busNum":"可用车辆数"
      }......
    ],
    "offices":[
      {
        "name":"办公地名称",
        "lnglat":[经度,纬度],
      }......
    ],
    "buses":[
      {
        "vno":"车辆自编号",
        "station":"所在待发车起讫站名称",
        "line":"所属线路名",
        "company":"所属公司"
      }......
    ]
  },
  //终点信息
  "end":{
    "companyNum":"涉及公司数",
    "officeNum":"涉及车队办公点数",
    "stationNum":"涉及起讫站数",
    "lineNum":"涉及线路数",
    "busNum":"涉及车辆数",
    "stations":[
      {
        "name":"站点名称",
        "lnglat":[经度,纬度],
        "busNum":"可用车辆数"
      }......
    ],
    "offices":[
      {
        "name":"办公地名称",
        "lnglat":[经度,纬度],
      }......
    ],
    "buses":[
      {
        "vno":"车辆自编号",
        "station":"所在待发车起讫站名称",
        "line":"所属线路名",
        "company":"所属公司"
      }......
    ]
  }
}
```



#### 4.1.2.2 保存目标点附近起讫站及可调用车辆查询结果

将uid对应的目标点附近起讫站及可调用车辆 搜索结果保存，记录在案

**请求参数**

| 参数 | 是否必填 | 格式   | 说明       |
| ---- | -------- | ------ | ---------- |
| uid  | 是       | 字符串 | 查询结果id |

**返回**

无



#### 4.1.2.3 资源配置档案列表

返回所有已配置档案列表，按时间倒序

**请求参数**

无 

**返回**

```
[
	{
		"uid":"档案id",
		"itemName":"轨交1号线应急支援",
		"line":"线路名",
		"beginStation":"人民广场",
		"endStation":"上海火车站",
		"createTime":"创建时间"
	}...
]
```



#### 4.1.2.4 资源配置档案详情

**请求参数**

| 参数 | 是否必填 | 格式   | 说明   |
| ---- | -------- | ------ | ------ |
| uid  | 是       | 字符串 | 档案id |

**返回**

```
{
	"uid":"查找结果id 也是保存结果时的档案id",
	"itemName":"轨交1号线应急支援",
	"line":"线路名",
	"createTime":"创建时间",
	"beginStation":"人民广场",
	"beginPoint":"121.32321,32.325678",
	"beginRange":"3",
	"endStation":"上海过车站",
	"endPoint":"121.32301,32.325631",
	"endRange":"2",
	//起点信息
	"begin":{
    "companyNum":"涉及公司数",
    "officeNum":"涉及车队办公点数",
    "stationNum":"涉及起讫站数",
    "lineNum":"涉及线路数",
    "busNum":"涉及车辆数",
    "stations":[
      {
        "name":"站点名称",
        "lnglat":[经度,纬度],
        "busNum":"可用车辆数"
      }......
    ],
    "offices":[
      {
        "name":"办公地名称",
        "lnglat":[经度,纬度],
      }......
    ],
    "buses":[
      {
        "vno":"车辆自编号",
        "station":"所在待发车起讫站名称",
        "line":"所属线路名",
        "company":"所属公司"
      }......
    ]
  },
  //终点信息
  "end":{
    "companyNum":"涉及公司数",
    "officeNum":"涉及车队办公点数",
    "stationNum":"涉及起讫站数",
    "lineNum":"涉及线路数",
    "busNum":"涉及车辆数",
    "stations":[
      {
        "name":"站点名称",
        "lnglat":[经度,纬度],
        "busNum":"可用车辆数"
      }......
    ],
    "offices":[
      {
        "name":"办公地名称",
        "lnglat":[经度,纬度],
      }......
    ],
    "buses":[
      {
        "vno":"车辆自编号",
        "station":"所在待发车起讫站名称",
        "line":"所属线路名",
        "company":"所属公司"
      }......
    ]
  }
}
```






# 5 云智库
## 5.1 智库首页
### 5.1.1 核心要素概况
围绕线、车、人、场、站五大核心要素做宏观统计显示。

**线路概况**
>线路总数

>环比去年（增加 N、持平 0、减少 -N）(条数)

**车辆概况**
>车辆总数

>环比去年（增加 N、持平 0、减少 -N）(辆数)

**人员概况**
>人员总数

>环比去年（增加 N、持平 0、减少 -N）(人数)

**停车场概况**
>专业停车场数

>智能化覆盖率

**站点概况**
>站点总数

>环比去年（增加 N、持平 0、减少 -N）(座数)

>预报覆盖百分比（电子站牌覆盖站点数据比例 百分比数值 不带%）

>预报覆盖环比去年（增加 N、持平 0、减少 -N，百分比数值 不带% 如减少20%则返回 -20）

**运送客流**
>去年 2018年运送人次（万人次）

>当年 2019年运送人次（万人次）

>当年运送人次曲线，提供月平均参考线


**请求参数**

无

**返回**

	{
		"line":{
			"count":"线路总数",
			"ringRatio": "环比 增加正数 持平0 减少负数",
		},
		bus:{
			"count":"车辆总数",
			"ringRatio": 40,			
		},
		stuff:{
			"count":"人员总数",
			"ringRatio": -20,		
		},
		parking:{
			"count":"停车场总数",
			"smartRatio": "智能化百分比",
		},
		station:{
			"count":"停车场总数",
			"ringRatio": 2,
			"forecast": "预报覆盖率百分比",
			"forecastRingRatio": "预报覆盖环比 增加正数 持平0 减少负数，如减少20% 则返回 -20"
		},
		passenger:{
			"lastYear":"去年运送人次",
			"thisYear":"当年运送人次",
			//人次曲线
			"curve":{
				"average" : "月平均参考数",
				//当年每月运送人数
				"list": [
					{
						"month":"月份",
						"count":"运送人数"
					}...
				]
			}
		}
	}


### 5.1.2 营运综合评价指标
**指标综合分数**

提供集团、公司指数达成情况，统计时间维度以数据中心可支持情况而定。
指数类型：
>综合指数

>运营调度指数

>营运效益指数

>信息化应用管理指数

>服务质量指数

>运营安全指数

**具体指标达成情况（该项数据细节需要数据中心提供）**

运营调度指数、营运效益指数、信息化应用管理指数、服务质量指数、运营安全指数五项指数，是由35项具体指标组成。
提供35项指标与五项指数的匹配关系，以及具体指标达成值。
数据可下钻至车队、线路级别。

#### 5.1.2.1 公司层面指标

**请求参数**

无。按照公司名称排序。

**返回**

```
// 按照公司名称排序
[
	{
		"year": "年",
		"months": "月",
		"level1_col_name": "一级分类名称",
		"level2_col_name": "二级分类名称",
		"level3_col_name": "三级分类名称",
		"data":[{
			"companyName": "公司名称",
			"dataValue": "指标数值"
		},{
			"companyName": "公司名称",
			"dataValue": "指标数值"
		}...]
	}...
]

```

#### 5.1.2.2 车队层面指标

**请求参数**

| 参数          | 是否必填 | 格式    | 说明                      |
| ----------- | ---- | ----- | ----------------------- |
| companyCode | 是    | 00-01 | 公司编码，提交此参数返回该公司下所有车队级信息 |

**返回**

```
// 按照车队名称排序
[
	{
		"year": "年",
		"months": "月",
		"level1_col_name": "一级分类名称",
		"level2_col_name": "二级分类名称",
		"level3_col_name": "三级分类名称",
		"companyCode": "公司编码",
		"companyName": "公司名称",
		"data":[{
			"filialeName": "车队名称",
			"dataValue": "指标数值"
		},{
			"filialeName": "车队名称",
			"dataValue": "指标数值"
		}...]
	}...
]
```

#### 5.1.2.3 线路层面指标

**请求参数**

| 参数          | 是否必填 | 格式       | 说明                     |
| ----------- | ---- | -------- | ---------------------- |
| filialeCode | 是    | 00-01-01 | 车队编码，提交此参数返回车队下所有线路级信息 |

**返回**

	// 按照线路名称排序
	[
		{
			"year": "年",
			"months": "月",
			"level1_col_name": "一级分类名称",
			"level2_col_name": "二级分类名称",
			"level3_col_name": "三级分类名称",
			"companyCode": "公司编码",
			"filialeCode": "车队编码",
			"companyName": "公司名称",
			"filialeName": "车队名称",
			"data":[{
				"lineName": "线路名称",
				"dataValue": "指标数值"
			},{
				"lineName": "线路名称",
				"dataValue": "指标数值"
			}...]
		}...
	]


### 5.1.3 安全管控
**交通违章**
>上一月间交通违章次数

>环比上上个月（上升 N、持平 0、下降 -N，百分比数值 不带% 如下降20%则返回 -20）（百分比）

>违章类型统计列表
>上一月最多的违章类型排序，提供该类违章数。
>同时提供该类违章数环比上上月的趋势。（上升:1、持平:0、下降:-1）

**事故统计**

公司上一个月的事故统计曲线，环比前一个月各公司增加、减少量的标示。提供公司平均参考线。

**事故多发点**

当年事故多发地点的排序，降序排序。（前十或者前五十，可修改）

**事故分析**

统计事故原因、事故种类、事故性质的占比。以年度累计数据进行统计分析。

**路口车速分析**

路口车速采集排序，按速度区间区分40≤车速＜50、50≤车速＜60、车速≥60，提供路口名和次数，降序排列。（提供前10，可修改）

**请求参数**

无

**返回**

	{
		//交通违章
		"violation":{
			"lastMonth": "上月交通违章次数",
			"ringRatio": "环比上上月 上升正数 下降负数 持平0，如下降20%则返回 -20",
			//违章类型统计列表
			"typeList":[
				{
					"name":"违章类型描述",
					"count":"此类违章数",
					"upDown":"上升:1、下降:-1、持平:0"
				}
			]
		},
		//事故统计
		"accidentCount": {
			"average":"平均参考值",
			//各公司事故统计列表
			"list":[
				{
					"company":"公司名",
					"count":"上月事故数",
					"ringRatio":"环比前一个月即上上个月增加 正数N、减少量 负数-N"
				}...	
			]
		},
		//事故多发点
		"accidentLocation":[
			{
				"name":"事故发生地",
				"count":"事故起数"
			}...
		],
		//事故分析
		"accidentAnalysis":{
			"reason":[
				{
					"name":"原因名称",
					"count":"起数"
				}...
			],
			"type":[
				{
					"name":"种类名称",
					"count":"起数"
				}...
			],
			"level":[
				{
					"name":"性质名称",
					"count":"起数"
				}...
			]
		},
		//路口车速
		"crossSpeed":[
			{
				"name":"服务端用来分类的车速范围描述字符串 如40<<车速<50",
				//此车速分类下 通过的路口名称和次数
				"list":[
					{
						"cross":"路口名",
						"count":"次数"
					},
					...
				]
			}
		]
	}

### 5.1.4智慧机务
#### 5.1.4.1留交车辆
留交车辆月曲线，提供月平均参考线

上月留交车型分析，降序排列留交次数最多的车型，并显示留交次数以及环比趋势（上升、持平、下降、新增）（前十排名）

**请求参数**

无

**返回**

	{
		//留交车月曲线
		"curve":{
			"average" : "月平均参考数",
			//当年每月数
			"list": [
				{
					"month":"月份",
					"count":"数值"
				}...
			]
		},
		//上月留交车型分析
		"analysis":[
			{
				"busType":"车型名称",
				"count":"留交起数",
				"upDown":"新增:2、上升:1、下降:-1、持平:0"
			}...
		]
	}
#### 5.1.4.2车辆路救
天气情况排名
晴天、下雨、下雪等不同天气类型下，出现路救情况的车型排序和次数，以次数降序排列。（前十）

温度情况排名
不同温度区间下，出现路救情况的车型排序和次数，以次数降序排列。（前十）

路救平均耗时

>上月路救平均耗时时间，环比上月趋势（上升、持平、下降）（百分比）

>当年路救平均耗时时间，环比去年趋势（上升、持平、下降）（百分比）

**请求参数**

无

**返回**

	{
		//天气情况排名
		"weather":[
			{
				"name":"天气",
				"list":[
					{
						"busType":"车型名称",
						"count":"路救起数"
					}...
				]
			}...
		],
		//温度情况排名
		"temperature":[
			{
				"name":"温度描述字符串 例如 10°C-20°C",
				"list":[
					{
						"busType":"车型名称",
						"count":"路救起数"
					}...
				]
			}...
		],
		//路救平均耗时
		"timeCost":{
			"lastMonth":{
				"cost":"平均耗时分钟",
				"ringRatio":"环比上上月 变化百分比 上升正数 下降负数 持平0，如下降20%则返回 -20"
			},
			"year":{
				"cost":"平均耗时分钟",
				"ringRatio":"环比去年 变化百分比 上升正数 下降负数 持平0，如下降20%则返回 -20"
			}
		}
	}


#### 5.1.4.3千公里材料费用
月千公里材料费用曲线，区分新能源和常规车型

以采购时间维度，统计不同采购年度车千公里材料费车型排序（按费用降序），并区分常规车型和新能源车型统计。

**请求参数**

无

**返回**

	{
		//材料费曲线月统计
		"curve":[
			{
				"month":"月份",
				"common":"常规车费用",
				"newEnergy":"新能源车费用"
			}...
		],
		//采购时间维度分析
		"analysis":[
			{
				"year":"采购年份",
				"common":[
					{
						"busType":"车型名称",
						"count":"材料费用"
					}...
				],
				"newEnergy":[
					{
						"busType":"车型名称",
						"count":"材料费用"
					}...
				]
			}...
		]
	}

#### 5.1.4.4新能源报警分析
1、按照月份分析报警次数，分为一级报警，二级报警，三级报警，从当前月份往前推6个月数据

2、按照日期分析报警次数，分为一级报警，二级报警，三级报警，从当前日往前推6天数据

**请求参数**

无

**返回**

	{
		//新能源报警分析月份统计
		"month":[		
			{
				"date":"月份 yyyy-MM",
				"monthFirst":"一级报警次数",
	            "monthSecond":"二级报警次数",
				"monthThird":"三级报警次数"
			}...	
		],
		//新能源报警分析月份统计
		"days":[		
			{
				"date":"日期 yyyy-MM-dd",
				"dayFirst":"一级报警次数",
	            "daySecond":"二级报警次数",
				"dayThird":"三级报警次数"
			}...	
		]
	}


​		
## 5.2数据中心
### 5.2.1节点机负载
节点机运行时负载状况，包括集群综合负载，各节点CPU使用率(百分比)、内存使用率(百分比)、磁盘使用率(百分比)、网络流量Mb/s

**请求参数**

无

**返回**

	{
		"load":"综合负载",
		//各节点详细负责
		"list":[
			{
				"uid":"设备ID",
				"cpu":"cpu使用率",
				"mem":"内存使用率",
				"disk":"磁盘使用率",
				"net":"网络流量"
			}...
		]
	}

### 5.2.2云服务器集群虚拟机情况
云服务器集群虚拟机分配情况，虚拟机划分了几个使用组
各分组内每台虚拟机实例负载情况

**请求参数**

无

**返回**

	[
		{
			"name":"使用组名称",
			"count":"分配的虚拟机数量",
			//该组虚拟机负载
			"list":[
				{
					"uid":"虚拟机ID",
					"cpu":"cpu使用率",
					"mem":"内存使用率",
					"disk":"磁盘使用率",
					"net":"网络流量"
				}...
			]
		}...
	]

### 5.2.3运维记录

**在线运维人员**

在线运维人员接入的ip地址

**运维服务访问历史记录**

记录运维的历史访问时间、登陆的ip地址、用户名

**请求参数**

无

**返回**

	{
		"online":[
			{
				"time":"访问时间",
				"ip":"访问的ip地址",
				"username":"用户名"
			}
		],
		//访问历史记录
		"accessHistory":[
			{
				"time":"访问时间",
				"ip":"访问的ip地址",
				"username":"用户名"
			}
		]
	}

### 5.2.4存储开支情况统计
存储总容量 单位字节
存储当前使用量 单位字节

**请求参数**

无

**返回**

	{
		"used":"当前使用量",
		"total":"总量"
	}

### 5.2.5机房人员进入记录
机房人员进入情况记录 进入时间 进入者姓名

**请求参数**

无

**返回**

	[
		{
			"name":"进入者姓名",
			"time":"进入时间",
			"status":"状态 进入机房 或 离开机房"
		}...
	]

### 5.2.6接入及共享业务系统
接入数据中心向数据中心上传数据的系统情况
接入数据中心调用数据中心数据服务的系统情况

**请求参数**

无

**返回**

	{
		//上传数据系统
		"inSystems":[
			{
				"uid":"系统id或编号",
				"name":"系统名称",
				"status":"系统状态 正常 或 异常"
			}
		],
		//调用分发数据系统
		"outSystems":[
			{
				"uid":"系统id或编号",
				"name":"系统名称",
				"status":"系统状态 正常 或 异常"
			}
		]
	}

### 5.2.7数据流量统计
数据中心数据交互流转情况

**实时数据交互笔数**

**数据量排序**

各系统每时段实时数据流量，统计时段和单位可由数据中心调整 
>排名

>系统名

>数据流量  输出是时段流量描述字符串如n笔/秒、n笔/分

>浮动 描述与上时段相比数据流量变动情况 升高+n、持平0、降低-n

**请求参数**

无

**返回**

	{
		"count":"实时数据交互笔数",
		//各系统数据量统计
		"list":[
			{
				"sequnce":"数据流量排名",
				"sysName":"系统名称",
				"count":"数据流量 n笔/秒",
				"upDown":"与上时段比增加或减少笔数，增加正数、减少负数"
			}
		]
	}
### 5.2.8数据资产监控
#### 5.2.8.1库资源结构图示
库资源结构，分类别以蜂窝结构显示数据资源结构，点击目标数据六边形，则下钻显示下一层数据资源。
使用着色区分表示该类数据资源下一层量级。暂定三级，分级区间以实际数据提交后的情况再定义。

**请求参数**

无

**返回**

	[
		{
			"category":"分类名称",
			//该分类下数据库明细
			"list":[
				{
					"uid":"数据库id",
					"name":"数据库名称",
					//下层数据资源数量级 值为字符串 s|m|l, 少:s,中等:m,多:l
					"childSiz":"m"
				}...
			]
		}...
	]

#### 5.2.8.2数据资产统计项目
**当前表数量**

当前数据资产表总量。

**当前数据项**

当前数据项总量。

**存储总量**

当前数据资产存储总量。

**本月新增表数量**

本月新增表总数。

**本月新增数据项**

本月新增数据项总数。

**本月存储增量**

本月数据资产存储量增加量总数。

**数据资产变动**
>源新增
>表示新增表单，提供表单名

>有更新
>表示表单数据字段更新，提供表单名

**请求参数**

无

**返回**

	{
		"tableCount":"当前表数量",
		"dataItemCount":"当前数据线数量",
		"storageCount":"存储总量",
		"newTable":"本月新增表数量",
		"newDataItem":"本月新增数据项",
		"newStorage":"本月存储增量",
		//数据资源变动
		"assetChange":[
			{
				"change":"变动类型 新增、更新、删除",
				"name":"资源名称",
				"dbUid":"数据库Id，无则空",
				"tableName":"表名称，无则空"
			}...
		]
	}



​	
## 5.3乘客密度分析
整体划分切分成3个部分显示应用，从左向右分别为：

**舒适度分析应用**

围绕车厢视频分析来行车乘客密度分析应用。

**地图展示应用**

为舒适度和POS数据分别提供图示应用。

**POS数据分析应用**

围绕POS数据分析提供行车乘客密度分析应用。

### 5.3.1舒适度分析应用
舒适度分析使用实时视频采集并经过计算机分析以获取车厢乘客密度，数据实时性高，故该部分应用使用实时内容显示。
#### 5.3.1.1车厢视频分析
**车厢视频分析接入**

- 线路接入统计：实时接入线路数/视频分析覆盖总线路数
- 车辆接入统计：实时接入车辆数/视频分析覆盖总车辆数

**视频分析处理负载**

- 当日已处理分析图片数/日均处理图片数
- 分析负载情况
  - 每秒处理多少张图分析
  - 每秒处理多少辆次分析

**请求参数**

无

**返回**

	{
		"link":{
			"lineCurrent":"实时接入线路数",
			"lineTotal":"视频分析覆盖总线路数",
			"busCurrent":"实时接入车辆数",
			"busTotal":"视频分析覆盖总车辆数"
		},
		"load":{
			"picCurrent":"当日已处理图片数",
			"picAverage":"日均处理图片数",
			"picPerSec":"每秒处理多少张图分析",
			"busPerSec":"每秒处理多少辆次分析"
		}
	}

#### 5.3.1.2舒适度情况
**使用码表标示集团所有营运车辆的整体舒适度情况**

- 显示当前所有营运车辆的整体舒适度指数和度量。
- 显示日均所有营运车辆的整体舒适度指数和度量。
- 显示早高峰所有营运车辆的整体舒适度指数和度量。
- 显示晚高峰所有营运车辆的整体舒适度指数和度量。

注：码表指针表示舒适度度量，指数表示度量所处在舒适、较舒适、拥挤的状态。
如早、晚高峰统计时间未到，则显示“暂无”。

**舒适度曲线**

对当日所有营运车辆的整体舒适度情况按时间段进行曲线表示。

注：由于目前舒适度分析还没有实现车辆接入全覆盖，所以在数据统计上只统计目前接入车辆的统计结果。

**请求参数**

无

**返回**

	{
		"current":"当前所有营运车辆整体舒适度",
		"average":"日均所有营运车辆整体舒适度",
		"earlyPeek":"早高峰所有营运车辆整体舒适度",
		"latePeek":"晚高峰所有营运车辆整体舒适度",
		"curve":[
			{
				"hour":"小时",
				"count":"整体舒适度"
			}...
		]
	}


#### 5.3.1.3线路舒适度示意线
- 绘制线路上下行图示线，以上下行车辆顺序位置进行着色，以显示当前线路车辆舒适度分布情况。
- 鼠标放置在图示线上，可以显示当前的舒适度具体数据统计，上下行分别表示。（舒适/较舒适/拥挤）
  自动轮巡滚动刷新，支持手动滚动。
- 点击图示线，切换至该线车辆具体采样图示，图片标注车号、识别数结果。（车辆编号、前车厢识别数/后车厢识别数、车厢模型分析数）
  手动滚动显示。

**复用一期云全景-线网-线路示意图、车辆示意图、车辆舒适度功能相应接口**

UI部分线路示意图变成线路舒适度示意图，所用到的数据和线路示意图一致，由原单条线路变成一次显示多条线路

### 5.3.2POS数据分析应用

### 5.3.2.1站点客流排名
**早高峰排名**

当日早高峰没有结束时，显示昨日的统计，当日早高峰结束后，更新为今日早高峰。
字段包含：排名、线路、运送乘客数、趋势、更新时间。
注：趋势为环比前一日上升、持平、下降的人数。

**晚高峰排名**

当日晚高峰没有结束时，显示昨日的统计，当日晚高峰结束后，更新为今日晚高峰。
字段包含：排名、线路、运送乘客数、趋势、更新时间。
注：趋势为环比前一日上升、持平、下降的人数。

**全日排名**

显示昨日的统计，营运结束后，进行更新。
字段包含：排名、线路、运送乘客数、趋势、更新时间。
注：趋势为环比前一日上升、持平、下降的人数。

**点击项目出现浮窗显示所有排名列表**

早高峰、晚高峰、全日排名项目按UI设计只取固定条数数据，start=1,end=n
点击早高峰、晚高峰、全日排名项目，可以弹出数据浮窗，显示所有线路的排名情况。
显示所有线路排名时按UI设计的分页方式，换页时start=n,end=n+m

**请求参数**

| 参数             | 是否必填 | 格式        | 说明                                       |
| -------------- | ---- | --------- | ---------------------------------------- |
| collectionName | 是    | 5_3_2_1_* | 早高峰，请求参数为 5_3_2_1_1。<br>晚高峰，请求参数为 5_3_2_1_2。<br>全日，请求参数为 5_3_2_1_3。 |
| start          | 否    | 数字        | 分也数据起始行                                  |
| end            | 否    | 数字        | 分也数据结束行                                  |

**返回**

	{
		"start":"数据起始行",
		"end":"数据结束行",
		"updateTime":"数据更新时间",
		"list":[
			{
				"idx":"排名",			
				"stationCode":"站点编号",
				"station":"站点名称",
				"passenger":"运送乘客",
				"change":"环比前日变化数值 增加正数、减少负数、持平 0",
				"idxChange":"排名浮动 字符串 增加+n、减少-n、持平 0"
			}...
		]
	}

### 5.3.2.2线路客流排名	
**早高峰排名**

当日早高峰没有结束时，显示昨日的统计，当日早高峰结束后，更新为今日早高峰。
字段包含：排名、站点编号、站点名称、运送乘客数、趋势、更新时间。
注：趋势为环比前一日上升、持平、下降的人数。

**晚高峰排名**

当日晚高峰没有结束时，显示昨日的统计，当日晚高峰结束后，更新为今日晚高峰。
字段包含：排名、站点编号、站点名称、运送乘客数、趋势、更新时间。
注：趋势为环比前一日上升、持平、下降的人数。

**全日排名**

显示昨日的统计，营运结束后，进行更新。
字段包含：排名、站点编号、站点名称、运送乘客数、趋势、更新时间。
注：趋势为环比前一日上升、持平、下降的人数。

**点击项目出现浮窗显示所有排名列表**

早高峰、晚高峰、全日排名项目按UI设计只取固定条数数据，start=1,end=n
点击早高峰、晚高峰、全日排名项目，可以弹出数据浮窗，显示所有线路的排名情况。
显示所有线路排名时按UI设计的分页方式，换页时start=n,end=n+m


**请求参数**

| 参数             | 是否必填 | 格式        | 说明                                       |
| -------------- | ---- | --------- | ---------------------------------------- |
| collectionName | 是    | 5_3_2_2_* | 早高峰，请求参数为 5_3_2_2_1。<br>晚高峰，请求参数为 5_3_2_2_2。<br>全日，请求参数为 5_3_2_2_3。 |
| start          | 否    | 数字        | 分也数据起始行                                  |
| end            | 否    | 数字        | 分也数据结束行                                  |

**返回**

	{
		"start":"数据起始行",
		"end":"数据结束行",
		"updateTime":"数据更新时间",
		"list":[
			{
				"idx":"排名",			
				"line":"线路名",
				"passenger":"运送乘客",
				"change":"环比前日变化数值 增加正数、减少负数、持平 0",
				"idxChange":"排名浮动 字符串 增加+n、减少-n、持平 0"
			}...
		]
	}


### 5.3.3GIS地图图示应用
在GIS地图上提供2个部分的客流图示。

**GIS-舒适度**
>- 支持实时显示和回放显示。回放时提供时间轴显示进度。

>- 车辆显示位置信息以及舒适度着色。着色凸显等级红色高于橙色高于绿色。
>  车辆着色效果需做热力图示效果设计，以凸显舒适度区域性分布特征。

>- 点击车辆图标 <br> 点击车辆，使用目前的视频点播窗支撑，显示车辆相关信息和分析样图。

>- 提供数据浮窗，统计营运车辆舒适、较舒适、拥挤的分布比例和具体车辆数。<br>
>  实时显示模式时，实时刷新统计数据。<br>
>  回放模式时，随播放进度刷新统计数据。

**GIS-站点客流**
>- 支持实时显示和回放显示。回放时提供时间轴显示进度。

>- 对站点进行客流等级标识，并通过标识的大小、颜色来标注客流等级。客流的数量统计是以时间间隔断面进行刷新，比如10分钟、30分钟，以数据可支撑情况而定。<br>
>  客流等级标识需要设计平滑变化的效果，达到近似呼吸灯的平滑效果，包括颜色变化和大小变化。

>- 提供数据浮窗显示线路客流排名以及站点客流排名。
>  实时显示模式时，实时刷新统计数据。
>  回放模式时，随播放进度刷新统计数据。<br>
>  线路客流排名 字段包括：排名、线路名、时间断面客流量（可以10分钟间隔，可定义）<br>
>  站点客流排名 字段包括：排名、站点编码、站点名、时间断面客流量（可以10分钟间隔，可定义）<br>
>  新增数据浮窗：
	- 当日累计客流人次
	- 3月运速客流人次
	- 同比去年（上升、下降、持平（人次））

>- 点击站点目标<br>
>  点击站点标识别，气泡显示该站点的客流信息。包括：
	- 站点名称，站点编码。
	- 15分钟该站点客流总值、该站点线路15分钟客流的分布比例、该站点线路15分钟客流数。
	- 该站点的日客流曲线图，鼠标停留可显示时间点线路客流明细。标注该站点的日客流累计数。

>- 扩展预留<br>
>  后续可能增加客流归属统计到行政区进行可视化显示，则需要站点归属到行政区的关联关系。


#### 5.3.3.1站点客流实时数据
返回站点当前实时客流数据

**请求参数**

无

**返回**

	{
		"daySum":"截止当前 当日累计客流数",
		"rankSlot":"统计排名的时间断面 由服务端统计算法设置 暂定15分钟，视需求可调整，返回分钟数值即可 如15分钟 返回15",
		//时段内站点 线路运送客流排名 取前10位，按客流量降序排列
		"rank":{
			//站点客流排名
			"stations":[
				{
					"name":"站点名称",
					"passflow":"客流"
				}...
			],
			//线路客流排名
			"lines":[
				{
					"name":"线路名称",
					"passflow":"客流"
				}...
			]
		},
		"list":[
			{
				"name":"站点名称",
				"code":"站点编码",
				"lng":"经度",
				"lat":"纬度",
				"passflow":"客流"
			}...
		]
	}...


#### 5.3.3.2站点客流分时段数据
返回24小时 各分时段客流数据，时段为每2个相邻的整点 如8点-9点 08-09, 13点-14点 13-14

各时段数据按时间升序排列

**请求参数**

无

**返回**

	[
		{
			"timeSlot":"时段 如 13-14",
			"daySum":"截止该时段 当日累计客流数",
			//时段内站点 线路运送客流排名 取前10位，按客流量降序排列
			"rank":{
				//站点客流排名
				"stations":[
					{
						"name":"站点名称",
						"passflow":"客流"
					}...
				],
				//线路客流排名
				"lines":[
					{
						"name":"线路名称",
						"passflow":"客流"
					}...
				]
			},
			"list":[
				{
					"name":"站点名称",
					"code":"站点编码",
					"lng":"经度",
					"lat":"纬度",
					"passflow":"客流"
				}...
			]
		}...
	]


#### 5.3.3.3 上月运送客流
**请求参数**

无

**返回**

	{
		"lastMonth": "上月运送客流，单位万人次",
		"yearOnyear": "同比去年 增加正数、减少负数 单位万人次"
	}

#### 5.3.3.4 站点客流明细
根据站点编号 返回站点客流明细，包括:

- 最近时段（15分钟）该站点客流线路分布
- 当日客流历史曲线

**请求参数**

| 参数   | 是否必填 | 格式     | 说明   |
| ---- | ---- | ------ | ---- |
| code | 是    | st0001 | 站点编码 |

**返回**

	"name":"站点名称",
	"code":"站点编码",
	//最近15分钟客流线路分布
	"current":[
		{
			"line":"线路名",
			"passflow":"客流"
		}...		
	],
	//当日客流历史曲线
	"curve":[
		{
			"time":"整点时间 如8点=8",
			"sum":"当日截至当前整点时间 客流累计数",
			"list":[
				{
					"line":"线路名",
					"passflow":"客流"
				}...
			]
		}...
	]

#### 5.3.3.5车辆舒适度分时段数据
返回24小时内车辆舒适度数据，每15分钟存一次车辆舒适度数据快照，每小时返回4批快照数据。

每次快照数据大小约为 40 * 5000 = 200k

一天数据大小约为 200k * 4 * 18 = 14,400k

**请求参数**

无

**返回**
​	
	[
		{
			"time":"时间 HH:mm, 如08:15",
			"distribution":{
				"comfort":"舒适车辆数",
				"mid":"较舒适车辆数",
				"crowd":"拥挤车辆数",
				"total":"舒适度分析车辆总数"
			},
			//车辆数据
			"list":[
				{
					"lng":"经度",
					"lat":"纬度",
					"v":"舒适度值 枚举 舒适、较舒适、拥挤 3个值"
				}...
			]
		}...
	]